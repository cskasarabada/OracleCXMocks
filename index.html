<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Redwood CXâ†’PPM Demo</title>
<link rel="stylesheet" href="assets/redwood.css"/>
<script defer src="assets/app.js"></script>
</head>
<body>
<header class="miconnex-bar">
  <div class="logo-mark">
    <span class="logo-icon argano">A</span>
    <div>
      <div class="logo-text">Argano</div>
      <div class="logo-sub">Connected Cloud</div>
    </div>
  </div>
  <div class="bar-actions">
    <button class="ghost-btn small">Help</button>
    <button class="ghost-btn small">Support</button>
    <div class="avatar-chip">CK</div>
  </div>
</header>
<nav class="quick-nav auto-nav">
  <div class="nav-group">
    <div class="nav-label">Sales &amp; Delivery Journey</div>
    <div class="nav-items">
      <a class="active" href="index.html">Overview</a>
      <a href="Easy_Start_Flows.html">Easy Start</a>
      <a href="sales_cloud.html">Sales Flow</a>
      <a href="sales_tools.html">Sales Tools</a>
      <a href="cx_lead.html">Lead</a>
      <a href="cx_opportunity.html">Opportunity</a>
      <a href="ppm_pursuit.html">PPM Pursuit</a>
      <a href="ppm_construction.html">PPM Construction</a>
      <a class="accent" href="quick_sales_screen.html">Quick Sales Screen</a>
    </div>
  </div>
  <div class="nav-group">
    <div class="nav-label">Insights &amp; Toolkit</div>
    <div class="nav-items">
      <a href="analytics.html">Analytics</a>
      <a href="forecasting_pipeline.html">Forecasting</a>
      <a href="integration_features.html">Integration</a>
      <a href="sales_process_visualization.html">Process Visualization</a>
      <a href="results_driven.html">Results Driven</a>
      <a href="executive_command_center.html">Exec Command</a>
      <a href="account_360.html">Account 360</a>
      <a href="partner_hub.html">Partner Hub</a>
      <a href="revenue_intelligence.html">Revenue Intelligence</a>
      <a href="field_mobile_snapshot.html">Field Mobile</a>
      <a href="sales_ppm_sync.html">Sales-PPM</a>
      <a href="quote_to_docusign.html">Quote to DocuSign</a>
      <a href="pursuit_project.html">Pursuit Project</a>
    </div>
  </div>
</nav>



<div class="shell index-shell">
  <section class="index-hero">
    <p class="eyebrow">Oracle CX + PPM</p>
    <h1>Connected Sales &amp; Delivery Journey</h1>
    <p class="hero-sub">Guide execs through the unified Lead &rarr; Opportunity &rarr; Pursuit &rarr; Project story while GenAI narrates status, risks, and smart actions.</p>
    <div class="index-hero-metrics">
      <div class="metric"><span class="metric-label">Scenario</span><strong id="indexScenarioName">Demo Account</strong></div>
      <div class="metric"><span class="metric-label">Lead</span><strong id="indexLeadStatus">--</strong></div>
      <div class="metric"><span class="metric-label">Opportunity</span><strong id="indexOppStatus">--</strong></div>
      <div class="metric"><span class="metric-label">Pursuit / Project</span><strong><span id="indexPursuitStatus">--</span> / <span id="indexProjectStatus">--</span></strong></div>
    </div>
    <div class="index-hero-search">
      <input type="search" id="indexSearchInput" placeholder="Search leads, opportunities, pursuits"/>
      <button type="button" class="btn" id="indexSearchBtn">Search</button>
    </div>
    <div class="index-search-results" id="indexSearchResults" aria-live="polite" aria-atomic="true" hidden></div>
  </section>

  <section class="index-ai-summary">
    <h3>Oracle GenAI Narrative</h3>
    <div id="indexAiSummaryText" class="ai-copy">Select a mode to narrate the connected CX Sales &amp; PPM journey.</div>
    <div class="ai-actions">
      <button class="btn brand" onclick="return runIndexAISummary('overview');">Overview</button>
      <button class="btn" onclick="return runIndexAISummary('risk');">Risks &amp; Signals</button>
      <button class="btn" onclick="return runIndexAISummary('action');">Smart Actions</button>
    </div>
  </section>

  <div class="index-layout">
    <div class="index-main">
      <div class="card index-flow-card"><h2>Flow Overview</h2><div class="body">
        <ol>
          <li><strong>Lead (CX Sales - Redwood)</strong>: qualify a lead and convert to Opportunity.</li>
          <li><strong>Opportunity (CX Sales - Redwood)</strong>: manage discovery, value engineering and next actions.</li>
          <li><strong>Quote</strong>: configure + price the solution, then deliver a customer-ready proposal.</li>
          <li><strong>PPM Pursuit</strong>: use OIC to open a pursuit record in PPM and refine estimates.</li>
          <li><strong>Project Delivery</strong>: award the pursuit to construction, track execution, and kick off warranty at substantial completion.</li>
        </ol>
        <p>Use the <strong>Sales Flow</strong> tab for a dedicated Oracle Sales Cloud storyline spanning lead, opportunity, quote, pursuit and project delivery.</p>
      </div></div>
      <div class="card" id="simulation-card">
        <h2>Realtime CX &amp; PPM Simulation</h2>
        <div class="body sim-deck">
          <p>Run a guided scenario to show data traveling from Lead &rarr; Opportunity &rarr; Pursuit &rarr; Project, with integration events logged along the way.</p>
          <div class="sim-controls">
            <label>Scenario
              <select id="simScenario"></select>
            </label>
            <a class="btn brand" href="#" id="btnStartSim">Start Guided Flow</a>
            <a class="btn" href="#" id="btnLoadScenario">Load Snapshot</a>
            <a class="btn outline" href="#" id="btnClearTimeline">Clear Timeline</a>
          </div>
          <ul class="event-feed" id="timelineList">
            <li class="empty">Timeline ready &mdash; start the sim to see Oracle CX Sales Cloud + PPM sync in action.</li>
          </ul>
        </div>
      </div>
    </div>
    <div class="index-side">
      <div class="card index-activity-card"><h2>Activity Log</h2><div class="body" id="log"></div></div>
      <div class="card index-agents-card"><h2>Agents</h2><div class="body">
    <div class="agents">
      <div class="agent">
        <h3>Sales Agent</h3>
        <p>Assist with lead qualification, follow-ups, and opportunity creation.</p>
        <div class="actions">
          <a class="btn" href="#" onclick="return startSalesAgentWithAssistant();">Start</a>
          <a class="btn" href="#" onclick="if(window.RWD && typeof RWD.stopAgent==='function'){ RWD.stopAgent('sales'); } return false;">Stop</a>
          <span class="agent-status" id="agent-sales-status">idle</span>
        </div>
      </div>
      <div class="agent">
        <h3>Forecasting Agent</h3>
        <p>Analyze pipeline data and suggest forecast adjustments.</p>
        <div class="actions">
          <a class="btn" href="#" onclick="return startForecastAgentWithAssistant();">Start</a>
          <a class="btn" href="#" onclick="if(window.RWD && typeof RWD.stopAgent==='function'){ RWD.stopAgent('forecast'); } return false;">Stop</a>
          <span class="agent-status" id="agent-forecast-status">idle</span>
        </div>
      </div>
      <div class="agent">
        <h3>Integration Agent</h3>
        <p>Simulate integrations between CX and PPM for demo scenarios.</p>
        <div class="actions">
          <a class="btn" href="#" onclick="return startIntegrationAgentWithAssistant();">Start</a>
          <a class="btn" href="#" onclick="if(window.RWD && typeof RWD.stopAgent==='function'){ RWD.stopAgent('integration'); } return false;">Stop</a>
          <span class="agent-status" id="agent-integration-status">idle</span>
        </div>
      </div>
    </div>
    <div class="stage-intel-inline">
      <h3>Agent Stage Intelligence</h3>
      <p>Use this quick board to show how Sales and Opportunity agents walk through every workflow step with integrated approvals.</p>
      <div class="stage-boards">
        <div class="stage-panel" data-stage="lead">
          <div class="stage-header">
            <div>
              <p class="eyebrow">Lead Journey</p>
              <h3>Qualify &amp; Route</h3>
            </div>
            <span class="stage-chip" id="stage-lead-current">--</span>
          </div>
          <p class="stage-desc">Sales Agent watches every lead step, ties Smart Actions to approvals, and alerts you when it&rsquo;s time to convert.</p>
          <ul class="stage-steps" id="stage-lead-steps"></ul>
          <div class="workflow-callouts">
            <span>Workflow: SDR capture &rarr; Marketing verify &rarr; AE acceptance</span>
            <span>Approvals: Lead source validation, data quality review</span>
          </div>
        </div>
        <div class="stage-panel" data-stage="opportunity">
          <div class="stage-header">
            <div>
              <p class="eyebrow">Opportunity Journey</p>
              <h3>Value Engineering &amp; Controls</h3>
            </div>
            <span class="stage-chip" id="stage-opportunity-current">--</span>
          </div>
          <p class="stage-desc">Opportunity Agent keeps the step-by-step workflow visible, including approvals for pricing, partners, and DocuSign.</p>
          <ul class="stage-steps" id="stage-opportunity-steps"></ul>
          <div class="workflow-callouts">
            <span>Workflow: Discovery &rarr; Solutioning &rarr; Proposal &rarr; Negotiation</span>
            <span>Approvals: Discount guardrails, partner onboarding, DocuSign legal pass</span>
          </div>
        </div>
      </div>
    </div>
  </div></div>
  <div class="card" id="agent-sim-card"><h2>AI Agent Simulation</h2>
    <div class="body agent-sim">
      <p>Use this board to narrate how Argano&rsquo;s CX Sales Cloud agents collaborate in real time. Start an agent to watch live intents, automations, and insights stream across each lane.</p>
      <div class="agent-sim-controls">
        <a class="btn brand" href="#" onclick="window.RWD && RWD.startAgent('sales'); window.RWD && RWD.startAgent('forecast'); window.RWD && RWD.startAgent('integration'); return false;">Start All Agents</a>
        <a class="btn" href="#" onclick="window.RWD && RWD.stopAgent('sales'); window.RWD && RWD.stopAgent('forecast'); window.RWD && RWD.stopAgent('integration'); return false;">Stop All</a>
      </div>
      <div class="agent-sim-grid">
        <div class="sim-panel" data-agent="sales">
          <div class="sim-head">
            <div>
              <p class="eyebrow">Sales CoPilot</p>
              <h3>Lead &amp; Opportunity Agent</h3>
            </div>
            <span class="chip" id="sim-sales-state">Idle</span>
          </div>
          <p class="sim-desc">Qualifies leads, logs follow-ups, and posts Smart Action nudges as tasks evolve.</p>
          <ul class="sim-feed" id="sim-sales-feed"></ul>
        </div>
        <div class="sim-panel" data-agent="forecast">
          <div class="sim-head">
            <div>
              <p class="eyebrow">Forecasting Analyst</p>
              <h3>Pipeline &amp; AI Insights</h3>
            </div>
            <span class="chip" id="sim-forecast-state">Idle</span>
          </div>
          <p class="sim-desc">Reads pipeline telemetry, posts acceleration ideas, and keeps leadership informed.</p>
          <ul class="sim-feed" id="sim-forecast-feed"></ul>
        </div>
        <div class="sim-panel" data-agent="integration">
          <div class="sim-head">
            <div>
              <p class="eyebrow">Integration Orchestrator</p>
              <h3>CPQ / DocuSign / PPM</h3>
            </div>
            <span class="chip" id="sim-integration-state">Idle</span>
          </div>
          <p class="sim-desc">Launches OIC flows, syncs pursuit cost sheets, and writes back doc statuses.</p>
          <ul class="sim-feed" id="sim-integration-feed"></ul>
        </div>
      </div>
    </div>
  </div>
    </div>
  </div>
</div>
<style>
#agent-sim-card .agent-sim{display:flex;flex-direction:column;gap:18px;}
.agent-sim-controls{display:flex;gap:10px;flex-wrap:wrap;}
.agent-sim-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:16px;}
.sim-panel{border:1px solid var(--rw-border);border-radius:18px;padding:16px;background:#fff6f0;}
.sim-head{display:flex;justify-content:space-between;align-items:flex-start;gap:10px;}
.sim-head h3{margin:0;font-size:1.1rem;}
.sim-desc{margin:8px 0 12px;color:#475569;font-size:13px;}
.chip{border-radius:999px;padding:4px 12px;font-size:12px;font-weight:600;background:#fef3c7;color:#b45309;}
.chip.running{background:#dcfce7;color:#15803d;}
.chip.stopped{background:#fee2e2;color:#991b1b;}
.sim-feed{list-style:none;margin:0;padding:0;min-height:96px;}
.sim-feed li{font-size:12px;padding:6px 8px;margin-bottom:6px;border-radius:8px;background:#fff;border:1px dashed rgba(255,122,24,.4);color:#7c2d12;}
.sim-feed li strong{display:block;color:#0f172a;}
.stage-boards{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:16px;}
.stage-panel{border:1px solid var(--rw-border);border-radius:20px;padding:16px;background:#f5f8ff;}
.stage-header{display:flex;justify-content:space-between;align-items:flex-start;gap:10px;}
.stage-desc{margin:8px 0 12px;font-size:13px;color:#475569;}
.stage-chip{border-radius:12px;padding:6px 12px;font-size:12px;font-weight:600;background:#e0edff;color:#0f3066;}
.stage-steps{list-style:none;margin:0;padding:0;display:flex;flex-direction:column;gap:8px;}
.stage-steps li{background:#fff;border-radius:12px;padding:10px;border:1px dashed rgba(15,48,102,.25);font-size:13px;}
.stage-steps li strong{color:#0f172a;display:block;}
.workflow-callouts{margin-top:12px;font-size:12px;color:#0f172a;display:flex;flex-direction:column;gap:6px;}
.workflow-callouts span{padding:6px 10px;border-radius:10px;background:#fff;border:1px solid rgba(255,122,24,.3);}
.stage-intel-inline{margin-top:18px;padding-top:18px;border-top:1px solid var(--rw-border);display:flex;flex-direction:column;gap:12px;}
#simulation-card .sim-deck{display:flex;flex-direction:column;gap:18px;}
.sim-controls{display:flex;flex-wrap:wrap;gap:12px;align-items:flex-end;}
.sim-controls label{font-size:11px;letter-spacing:.18em;text-transform:uppercase;color:#475569;display:flex;flex-direction:column;gap:6px;}
.sim-controls select{min-width:210px;border-radius:10px;border:1px solid var(--rw-border);padding:8px 10px;font-size:14px;}
.event-feed{list-style:none;margin:0;padding:0;display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:12px;}
.event-feed li{border:1px solid var(--rw-border);border-radius:16px;padding:12px;background:#fff;}
.event-head{display:flex;justify-content:space-between;font-size:12px;color:#64748b;margin-bottom:6px;}
.event-head .stage{font-weight:600;color:#0f172a;}
.event-feed li strong{display:block;margin-bottom:4px;color:#0f172a;}
.event-feed li p{margin:0;font-size:12px;color:#475569;}
.event-feed .empty{text-align:center;color:#94a3b8;font-style:italic;padding:14px;}
@media(max-width:640px){
  .agent-sim-controls{flex-direction:column;}
}
</style>
 <script>
  window.addEventListener('DOMContentLoaded', function(){
   var indexAiMode='overview';
   function safeState(){
     var stub={logs:[],timeline:[],lead:{},oppty:{},pursuit:{},const:{}};
     if(window.RWD && typeof RWD.get==='function'){
       try{
         var live=RWD.get();
         return Object.assign(stub, live||{});
       }catch(e){
         console.warn('RWD.get failed', e);
       }
     }
     return stub;
   }
   var d=safeState();
   window.IndexDemoState=d;
   hydrateIndexHero(d);
   attachHeroActions();
   renderIndexAISummary(indexAiMode,d);
   window.runIndexAISummary=function(mode){
     indexAiMode=mode||'overview';
     return renderIndexAISummary(indexAiMode, window.IndexDemoState || safeState());
   };
  var log=document.getElementById('log');
   if(log && Array.isArray(d.logs)){
     d.logs.forEach(function(m){
       var p=document.createElement('div');
       p.textContent=m;
       log.appendChild(p);
     });
   }
   function hydrateIndexHero(state){
      state=state||{};
      var scenario=(state.lead && state.lead.company)||'Demo Account';
      var leadStatus=(state.lead && state.lead.status)||'Working';
      var oppStatus=(state.oppty && (state.oppty.stage||state.oppty.status))||'Qualification';
      var pursuitStatus=(state.pursuit && state.pursuit.status)||'Draft';
      var projectStatus=(state.const && state.const.status)||'Planning';
      var map={
        indexScenarioName:scenario,
        indexLeadStatus:leadStatus,
        indexOppStatus:oppStatus,
        indexPursuitStatus:pursuitStatus,
        indexProjectStatus:projectStatus
      };
      Object.keys(map).forEach(function(id){
        var el=document.getElementById(id);
        if(el) el.textContent=map[id];
      });
   }
    function attachHeroActions(){
      var startBtn=document.getElementById('heroStartSim');
      if(startBtn){
        startBtn.addEventListener('click', function(ev){
          ev.preventDefault();
          var simBtn=document.getElementById('btnStartSim');
          if(simBtn) simBtn.click();
        });
      }
      var resetBtn=document.getElementById('heroResetState');
      if(resetBtn){
        resetBtn.addEventListener('click', function(ev){
          ev.preventDefault();
          if(window.RWD && typeof RWD.reset==='function'){
            RWD.reset();
            window.location.reload();
          }else{
            alert('Demo engine unavailable offline');
          }
        });
      }
      var searchInput=document.getElementById('indexSearchInput');
      var searchBtn=document.getElementById('indexSearchBtn');
      if(searchInput){
        searchInput.addEventListener('keypress', function(ev){
          if(ev.key==='Enter'){
            ev.preventDefault();
            runIndexSearch(searchInput.value);
          }
        });
      }
      if(searchBtn){
        searchBtn.addEventListener('click', function(ev){
          ev.preventDefault();
          runIndexSearch(searchInput?searchInput.value:'');
        });
      }
    }
    function renderIndexAISummary(mode,state){
      var target=document.getElementById('indexAiSummaryText');
      if(!target) return false;
      state=state||{};
     var lead=(state.lead && state.lead.status)||'Working';
     var opp=(state.oppty && (state.oppty.stage||state.oppty.status))||'Qualification';
     var pursuit=(state.pursuit && state.pursuit.status)||'Draft';
     var project=(state.const && state.const.status)||'Planning';
     var scenario=(state.lead && state.lead.company)||'the primary account';
     var message='';
     if(mode==='risk'){
       message='<strong>Risk signals:</strong> lead is '+lead+' while opportunity is '+opp+', so ensure approvals stay in lockstep.<ul><li>Pursuit at '+pursuit+' needs pricing and cost reviews before handoff.</li><li>Watch integration jobs when converting to project ('+project+').</li><li>Agents can nudge teams when data quality slips.</li></ul>';
     }else if(mode==='action'){
       message='<strong>Smart Actions:</strong><ul><li>Launch the guided flow to show data syncing end-to-end.</li><li>Open Sales/Forecast/Integration assistants to stream AI insights.</li><li>Use the Quick Sales screen for fast-track expansions once pursuit is '+pursuit+'.</li></ul>';
     }else{
       message='<strong>Overview:</strong> '+scenario+' is moving from '+lead+' lead to '+opp+' opportunity with pursuit '+pursuit+' and project '+project+'. GenAI keeps every handoff narrated so execs and delivery stay aligned.';
     }
      target.innerHTML=message;
      return false;
    }
    function runIndexSearch(query){
      var panel=document.getElementById('indexSearchResults');
      if(!panel) return false;
      var trimmed=(query||'').trim();
      if(!trimmed){
        panel.hidden=true;
        if(typeof showToast==='function') showToast('Enter a search term for leads, opportunities, or pursuits.');
        return false;
      }
      var state=window.IndexDemoState || safeState();
      var hits=[];
      if(state.lead && state.lead.company && state.lead.company.toLowerCase().includes(trimmed.toLowerCase())){
        hits.push({label:'Lead', desc:state.lead.company+' — '+(state.lead.status||'Working')});
      }
      if(state.oppty && state.oppty.name && state.oppty.name.toLowerCase().includes(trimmed.toLowerCase())){
        hits.push({label:'Opportunity', desc:state.oppty.name+' — '+(state.oppty.stage||'Qualification')});
      }
      if(state.pursuit && state.pursuit.name && state.pursuit.name.toLowerCase().includes(trimmed.toLowerCase())){
        hits.push({label:'Pursuit', desc:state.pursuit.name+' — '+(state.pursuit.status||'Draft')});
      }
      if(state.const && state.const.name && state.const.name.toLowerCase().includes(trimmed.toLowerCase())){
        hits.push({label:'Project', desc:state.const.name+' — '+(state.const.status||'Planning')});
      }
      if(!hits.length){
        panel.hidden=false;
        panel.innerHTML='<h4>No Results</h4><p>Nothing matched “‘+trimmed+'”. Start a guided flow to load that scenario.</p>';
        return false;
      }
      panel.hidden=false;
      panel.innerHTML='<h4>Search Results</h4><ul>'+hits.map(function(hit){ return '<li><strong>'+hit.label+':</strong> '+hit.desc+'</li>'; }).join('')+'</ul>';
      return false;
    }
    // Periodically refresh agent status display
    const lastActionCache={};
    function pushFeed(agent,action){
      if(!action || action==='stopped') return;
      if(lastActionCache[agent]===action) return;
      lastActionCache[agent]=action;
      const list=document.getElementById('sim-'+agent+'-feed');
      if(!list) return;
      const li=document.createElement('li');
      li.innerHTML='<strong>'+new Date().toLocaleTimeString()+'</strong>'+action;
      list.insertBefore(li,list.firstChild);
      while(list.children.length>4){ list.removeChild(list.lastChild); }
    }
    function updateChip(agent,state){
      const chip=document.getElementById('sim-'+agent+'-state');
      if(!chip) return;
      const status = state.running ? 'running' : 'stopped';
      chip.textContent = status.charAt(0).toUpperCase()+status.slice(1);
      chip.classList.remove('running','stopped');
      chip.classList.add(status);
    }
    function refreshAgentStatus(){
      try{
        var s = (window.RWD && typeof RWD.getAgentStates==='function') ? RWD.getAgentStates() : {};
        var sales = s.sales || s['sales agent'] || {};
        var fc = s.forecast || s['forecasting agent'] || {};
        var integ = s.integration || s['integration agent'] || {};
        var elSales = document.getElementById('agent-sales-status');
        var elFc = document.getElementById('agent-forecast-status');
        var elInt = document.getElementById('agent-integration-status');
        if(elSales) elSales.textContent = (sales.running ? 'running' : 'stopped') + (sales.lastAction ? ' â€” '+sales.lastAction : '');
        if(elFc) elFc.textContent = (fc.running ? 'running' : 'stopped') + (fc.lastAction ? ' â€” '+fc.lastAction : '');
        if(elInt) elInt.textContent = (integ.running ? 'running' : 'stopped') + (integ.lastAction ? ' â€” '+integ.lastAction : '');
        updateChip('sales', sales);
        updateChip('forecast', fc);
        updateChip('integration', integ);
        pushFeed('sales', sales.lastAction);
        pushFeed('forecast', fc.lastAction);
        pushFeed('integration', integ.lastAction);
      }catch(e){ console.log('refreshAgentStatus', e); }
    }
    refreshAgentStatus();
    setInterval(refreshAgentStatus, 2000);
    const scenarioSelect=document.getElementById('simScenario');
    const timelineList=document.getElementById('timelineList');
    function fallbackScenarios(){
      return [{key:'demo',label:'Demo CXâ†’PPM Story'}];
    }
    function populateScenarios(){
      if(!scenarioSelect) return;
      var options=[];
      if(window.RWD && typeof RWD.availableScenarios==='function'){
        options=RWD.availableScenarios()||[];
      }
      if(!options.length) options=fallbackScenarios();
      scenarioSelect.innerHTML='';
      options.forEach(function(opt,index){
        const option=document.createElement('option');
        option.value=opt.key;
        option.textContent=opt.label;
        if(index===0) option.selected=true;
        scenarioSelect.appendChild(option);
      });
    }
    function renderTimeline(state){
      if(!timelineList) return;
      const events=(state && state.timeline ? state.timeline : []).slice(0,8);
      if(!events.length){
        timelineList.innerHTML='<li class="empty">Timeline ready &mdash; start the sim to connect CX Sales Cloud with PPM.</li>';
        return;
      }
      timelineList.innerHTML=events.map(function(evt){
        return '<li><div class="event-head"><span class="stage">'+(evt.stage||'Stage')+'</span><span class="ts">'+evt.ts+'</span></div><strong>'+ (evt.event||'Update') +'</strong><p>'+(evt.detail||'')+'</p></li>';
      }).join('');
    }
    populateScenarios();
    renderTimeline(d);
    const btnStart=document.getElementById('btnStartSim');
    function guidedSampleTimeline(){
      var now=new Date();
      return [
        {stage:'Lead',ts:now.toLocaleString(),event:'Qualified',detail:'AE verified scope & budget'},
        {stage:'Opportunity',ts:now.toLocaleString(),event:'Proposal',detail:'Quote delivered with CPQ bundle'},
        {stage:'Pursuit',ts:now.toLocaleString(),event:'Costing',detail:'PPM pursuit estimating in-flight'},
        {stage:'Project',ts:now.toLocaleString(),event:'Awarded',detail:'Construction kickoff ready'}
      ];
    }

    if(btnStart){
      btnStart.addEventListener('click', function(ev){
        ev.preventDefault();
        const scenarioKey=scenarioSelect ? scenarioSelect.value : undefined;
        if(window.RWD && typeof RWD.runScenarioFlow==='function'){
          btnStart.textContent='Simulating...';
          RWD.runScenarioFlow({scenario:scenarioKey}).finally(function(){
            btnStart.textContent='Start Guided Flow';
          });
        }else{
          renderTimeline({timeline:guidedSampleTimeline()});
          if(typeof showToast==='function') showToast('Guided flow simulated (offline)');
        }
      });
    }
    const btnLoad=document.getElementById('btnLoadScenario');
    if(btnLoad){
      btnLoad.addEventListener('click', function(ev){
        ev.preventDefault();
        const scenarioKey=scenarioSelect ? scenarioSelect.value : undefined;
        if(window.RWD && typeof RWD.loadScenario==='function'){
          RWD.loadScenario(scenarioKey);
        }else{
          renderTimeline({timeline:guidedSampleTimeline()});
          if(typeof showToast==='function') showToast('Loaded demo snapshot');
        }
      });
    }
    const btnClear=document.getElementById('btnClearTimeline');
    if(btnClear){
      btnClear.addEventListener('click', function(ev){
        ev.preventDefault();
        if(window.RWD && typeof RWD.clearTimeline==='function'){
          RWD.clearTimeline();
        }else{
          renderTimeline({timeline:[]});
          if(typeof showToast==='function') showToast('Timeline cleared');
        }
      });
    }
    window.startSalesAgentWithAssistant=function(){
      if(window.RWD && typeof RWD.startAgent==='function'){ RWD.startAgent('sales'); }
      openSalesAssistant();
      return false;
    };
    function openSalesAssistant(){
      const modal=document.getElementById('sales-assistant-modal');
      if(!modal) return;
      modal.classList.add('visible');
      const feed=modal.querySelector('.chat-feed');
      if(feed && !feed.dataset.seeded){
        feed.dataset.seeded='1';
        appendAssistantMessage('Need anything on leads, opps, or pursuits? Ask me and I will pull live demo data.');
      }
      document.getElementById('sales-assistant-input').focus();
    }
    window.closeSalesAssistant=function(){
      document.getElementById('sales-assistant-modal').classList.remove('visible');
    };
    function appendMessage(sender,text){
      const feed=document.querySelector('#sales-assistant-modal .chat-feed');
      if(!feed) return;
      const li=document.createElement('li');
      li.className='msg '+sender;
      li.innerHTML='<span>'+text+'</span>';
      feed.appendChild(li);
      feed.scrollTop=feed.scrollHeight;
    }
    function appendAssistantMessage(text){ appendMessage('assistant', text); }
    function appendUserMessage(text){ appendMessage('user', text); }
    window.sendSalesAssistantMessage=function(ev){
      ev.preventDefault();
      const input=document.getElementById('sales-assistant-input');
      const q=(input.value||'').trim();
      if(!q) return false;
      appendUserMessage(q);
      input.value='';
      setTimeout(function(){ respondFromDemoData(q); }, 400);
      return false;
    };
    function respondFromDemoData(q){
      const data = safeState();
      const lower=q.toLowerCase();
      let answer='';
      if(lower.includes('lead')){
        answer='Latest lead: '+(data.lead.company||'Unnamed')+' ('+(data.lead.contact||'contact TBD')+') score '+(data.lead.score||'60')+'. We can convert or nudge via Smart Actions.';
      }else if(lower.includes('opportunity')||lower.includes('deal')){
        answer='Opportunity "'+(data.oppty.name||'New Build')+'" at $'+(data.oppty.amount||250000).toLocaleString()+' is in '+(data.oppty.stage||'Qualification')+'. Need a next step? I can suggest partner involvement or run a CPQ quote.';
      }else if(lower.includes('pursuit')||lower.includes('ppm')){
        answer='Pursuit "'+(data.pursuit.name||'Demo Pursuit')+'" is '+(data.pursuit.status||'Draft')+' with estimate $'+(data.pursuit.estimate||0).toLocaleString()+'. Integration agent is ready to sync cost sheets.';
      }else if(lower.includes('project')){
        answer='Delivery project "'+(data.const.name||'Demo Construction')+'" is '+(data.const.status||'Planned')+' with budget $'+(data.const.budget||0).toLocaleString()+'. I can highlight schedule or warranty milestones.';
      }else if(lower.includes('help')||lower.includes('what can you do')){
        answer='I can qualify leads, propose next actions, launch approvals, or create pursuits via OIC. Just ask about leads, opportunities, quotes, or delivery.';
      }else{
        answer='I pulled context but need a specific area (lead, opportunity, pursuit, project). Ask something like "What\'s the status of our pursuit?" and I will respond with live data.';
      }
      appendAssistantMessage(answer);
    }
    function renderStageBoards(state){
      const data = state || safeState();
      const leadList=document.getElementById('stage-lead-steps');
      const oppList=document.getElementById('stage-opportunity-steps');
      const stages=(window.RWD && RWD.flowStages)||[];
      const leadStage=stages.find(s=>s.key==='lead');
      const oppStage=stages.find(s=>s.key==='opportunity');
      if(leadStage && leadList){
        document.getElementById('stage-lead-current').textContent=(data.lead.status||leadStage.statuses[0]);
        leadList.innerHTML='';
        leadStage.statuses.forEach(function(step){
          const li=document.createElement('li');
          const highlight = (data.lead.status||'').toLowerCase()===step.toLowerCase();
          li.innerHTML='<strong>'+step+'</strong>'+(highlight?'<span style="color:#16a34a;font-weight:600">Current via Sales Agent</span>':'<span>Smart Action ready</span>');
          leadList.appendChild(li);
        });
      }
      if(oppStage && oppList){
        document.getElementById('stage-opportunity-current').textContent=(data.oppty.stage||oppStage.statuses[0]);
        oppList.innerHTML='';
        oppStage.statuses.forEach(function(step){
          const li=document.createElement('li');
          const highlight=(data.oppty.stage||'').toLowerCase()===step.toLowerCase();
          li.innerHTML='<strong>'+step+'</strong>'+(highlight?'<span style="color:#ff7a18;font-weight:600">Agent engaged</span>':'<span>Approvals queued</span>');
          oppList.appendChild(li);
        });
      }
    }
    function handleState(snapshot){
      var latest=snapshot || safeState();
      window.IndexDemoState=latest;
      hydrateIndexHero(latest);
      renderIndexAISummary(indexAiMode, latest);
      renderStageBoards(latest);
      renderTimeline(latest);
    }
    handleState(d);
    if(window.RWD && typeof RWD.subscribe==='function'){
      RWD.subscribe(handleState);
    }
    window.startForecastAgentWithAssistant=function(){
      if(window.RWD && typeof RWD.startAgent==='function'){ RWD.startAgent('forecast'); }
      openForecastAssistant();
      return false;
    };
    function openForecastAssistant(){
      var modal=document.getElementById('forecast-assistant-modal');
      if(!modal) return;
      var feed=document.getElementById('forecast-assistant-feed');
      if(feed){
        feed.innerHTML='';
        appendForecastInsight();
      }
      modal.classList.add('visible');
    }
    window.closeForecastAssistant=function(){
      var modal=document.getElementById('forecast-assistant-modal');
      if(modal) modal.classList.remove('visible');
    };
    function appendForecastInsight(){
      var feed=document.getElementById('forecast-assistant-feed');
      if(!feed) return;
      var data=safeState();
      var amount=(data.oppty && data.oppty.amount) || 480000;
      var prob=(data.oppty && data.oppty.stage==='Proposal')?0.68:0.42;
      var text='Pipeline at $'+Number(amount).toLocaleString()+' with win confidence '+Math.round(prob*100)+'%. Recommend focusing on '+(data.oppty && data.oppty.name ? data.oppty.name : 'top pursuit')+'.';
      var li=document.createElement('li');
      li.className='msg assistant';
      li.innerHTML='<span>'+text+'</span>';
      feed.appendChild(li);
      feed.scrollTop=feed.scrollHeight;
    }
    window.refreshForecastInsight=function(){
      var feed=document.getElementById('forecast-assistant-feed');
      if(feed) feed.innerHTML='';
      appendForecastInsight();
    };

    window.startIntegrationAgentWithAssistant=function(){
      if(window.RWD && typeof RWD.startAgent==='function'){ RWD.startAgent('integration'); }
      openIntegrationAssistant();
      return false;
    };
    function openIntegrationAssistant(){
      var modal=document.getElementById('integration-assistant-modal');
      if(!modal) return;
      var feed=document.getElementById('integration-assistant-feed');
      if(feed){
        feed.innerHTML='';
        appendIntegrationInsight();
      }
      modal.classList.add('visible');
    }
    window.closeIntegrationAssistant=function(){
      var modal=document.getElementById('integration-assistant-modal');
      if(modal) modal.classList.remove('visible');
    };
    function appendIntegrationInsight(){
      var feed=document.getElementById('integration-assistant-feed');
      if(!feed) return;
      var data=safeState();
      var steps=[
        'Pushed quote to CPQ for '+((data.oppty&&data.oppty.name)||'current opportunity'),
        'DocuSign ready with '+((data.oppty&&data.oppty.account)||'customer'),
        'PPM Pursuit synced with estimate '+Number((data.pursuit&&data.pursuit.estimate)||0).toLocaleString()
      ];
      steps.forEach(function(msg){
        var li=document.createElement('li');
        li.className='msg assistant';
        li.innerHTML='<span>'+msg+'</span>';
        feed.appendChild(li);
      });
      feed.scrollTop=feed.scrollHeight;
    }
    window.refreshIntegrationInsight=function(){
      var feed=document.getElementById('integration-assistant-feed');
      if(feed) feed.innerHTML='';
      appendIntegrationInsight();
    };
 });
 </script>
<div id="sales-assistant-modal" class="agent-modal">
  <div class="agent-modal-content">
    <header>
      <div>
        <p class="eyebrow">Argano GenAI</p>
        <h3>Sales Agent Assist</h3>
      </div>
      <button class="ghost-btn small" onclick="closeSalesAssistant()">Close</button>
    </header>
    <ul class="chat-feed"></ul>
    <form class="chat-compose" onsubmit="return sendSalesAssistantMessage(event);">
      <input type="text" id="sales-assistant-input" placeholder="Ask about a lead, opportunity, quote, or pursuit..." autocomplete="off"/>
      <button class="btn brand" type="submit">Ask</button>
    </form>
  </div>
</div>

<div id="forecast-assistant-modal" class="agent-modal">
  <div class="agent-modal-content">
    <header>
      <div>
        <p class="eyebrow">Forecasting Analyst</p>
        <h3>Pipeline &amp; AI Insights</h3>
      </div>
      <button class="ghost-btn small" onclick="closeForecastAssistant()">Close</button>
    </header>
    <ul class="chat-feed" id="forecast-assistant-feed"></ul>
    <div class="chat-compose">
      <button class="btn brand" type="button" onclick="refreshForecastInsight()">Refresh Insight</button>
    </div>
  </div>
</div>

<div id="integration-assistant-modal" class="agent-modal">
  <div class="agent-modal-content">
    <header>
      <div>
        <p class="eyebrow">Integration Orchestrator</p>
        <h3>CPQ / DocuSign / PPM</h3>
      </div>
      <button class="ghost-btn small" onclick="closeIntegrationAssistant()">Close</button>
    </header>
    <ul class="chat-feed" id="integration-assistant-feed"></ul>
    <div class="chat-compose">
      <button class="btn brand" type="button" onclick="refreshIntegrationInsight()">Refresh Flow</button>
    </div>
  </div>
</div>
<style>
.agent-modal{position:fixed;inset:0;background:rgba(6,16,41,.6);display:flex;align-items:center;justify-content:center;opacity:0;pointer-events:none;transition:opacity .2s ease;z-index:999;}
.agent-modal.visible{opacity:1;pointer-events:auto;}
.agent-modal-content{width:min(480px,90vw);background:#fff;border-radius:20px;padding:18px;box-shadow:0 30px 70px rgba(0,0,0,.35);display:flex;flex-direction:column;gap:12px;}
.agent-modal-content header{display:flex;justify-content:space-between;align-items:center;}
.chat-feed{list-style:none;margin:0;padding:0;height:280px;overflow:auto;border:1px solid var(--rw-border);border-radius:14px;padding:10px;display:flex;flex-direction:column;gap:10px;background:#f8fafc;}
.chat-feed .msg{display:flex;}
.chat-feed .msg span{padding:10px 12px;border-radius:14px;font-size:13px;line-height:1.3;max-width:90%;}
.chat-feed .msg.user{justify-content:flex-end;}
.chat-feed .msg.user span{background:#ffeadb;color:#7c2d12;}
.chat-feed .msg.assistant span{background:#0f172a;color:#fff;}
.chat-compose{display:flex;gap:10px;}
.chat-compose input{flex:1;border:1px solid var(--rw-border);border-radius:12px;padding:10px 12px;font-size:14px;}
</style>
<div class="footer">Â© Demo â€“ Redwood-inspired mockup</div></div>
</body>
</html>

