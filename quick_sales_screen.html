<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Quick Sales Screen for Existing Customers</title>
<link rel="stylesheet" href="assets/redwood.css"/>
<script defer src="assets/app.js"></script>
<script defer src="assets/quick_sales_data.js"></script>
</head>
<body>

<div id="aria-live" aria-live="polite" aria-atomic="true" class="visually-hidden"></div>

<div class="header"><span class="product">Oracle CX & PPM</span><span class="trail">/ Quick Sales Screen</span></div>
<div class="shell">
  <div style="max-width:980px;margin:18px auto">
    <h1>Quick Sales Screen for Existing Customers</h1>
    <p>Show the streamlined experience tailored for short-cycle expansions. For existing customers with established relationships and pre-approved terms, the Quick Sales screen enables a condensed three-stage progression that dramatically reduces cycle time while maintaining controls and documentation.</p>
  </div>

  <div class="card" style="max-width:980px;margin:0 auto 18px;">
    <div class="body">
      <div class="quick-grid">
        <div>
          <h3>Smart Account Intelligence</h3>
          <ul>
            <li>Existing account selector with search and favorites.</li>
            <li>Prior project history &amp; performance summary.</li>
            <li>Contact roles &amp; decision maker directory.</li>
            <li>Relationship timeline plus engagement tracking.</li>
          </ul>
        </div>
        <div>
          <h3>Accelerated Transaction Tools</h3>
          <ul>
            <li>Current needs / expansion request form.</li>
            <li>Pre-approved pricing &amp; rate cards.</li>
            <li>Quick Quote launch with CPQ integration.</li>
            <li>Short-form opportunity creation with minimal fields.</li>
          </ul>
        </div>
        <div>
          <h3>Condensed 3-Stage Progression</h3>
          <ol class="quick-steps">
            <li><strong>1. Account + Need Confirmation:</strong> Validate the existing relationship, confirm scope, and document the expansion trigger.</li>
            <li><strong>2. Pre-Built Quote + Approval:</strong> Launch the Quick Quote path with embedded controls, auto-attach documentation, and route fast approvals.</li>
            <li><strong>3. Execution &amp; Handoff:</strong> Convert to an opportunity with the required artifacts attached, then hand off to delivery without re-keying.</li>
          </ol>
        </div>
      </div>
    </div>
  </div>

  <div style="max-width:980px;margin:6px auto 24px;text-align:center">
    <button class="btn primary" onclick="presetQuickSales()" style="font-size:1.05em;padding:12px 20px;">Preview Quick Sales Demo</button>
    <button type="button" class="btn" onclick="startInteractiveFlow()" style="font-size:1.05em;padding:12px 20px;margin-left:8px;">Start Interactive Flow</button>
    <a class="btn" href="sales_cloud.html">Back to Sales Flow</a>
  </div>

  <div style="max-width:980px;margin:6px auto 24px;">
    <div style="display:flex;gap:8px;align-items:center;justify-content:flex-end;margin-bottom:8px">
      <button type="button" class="btn" id="show-sample-data" onclick="toggleSampleData()">Show Sample Leads & Quotes</button>
    </div>
    <div id="sample-data-panel" style="display:none;border:1px solid var(--rw-border);padding:12px;border-radius:8px;background:var(--rw-surface)">
      <h3>Sample Leads</h3>
      <div style="overflow:auto;max-height:200px;margin-bottom:12px" id="sample-leads"></div>
      <h3>Sample Quotes</h3>
      <div style="overflow:auto;max-height:240px" id="sample-quotes"></div>
    </div>
  </div>

    <script>
    function toggleSampleData(){
      var panel = document.getElementById('sample-data-panel');
      if(!panel) return;
      if(panel.style.display==='none' || !panel.style.display){
        renderSampleData(); panel.style.display='block'; document.getElementById('show-sample-data').textContent='Hide Sample Data';
      } else { panel.style.display='none'; document.getElementById('show-sample-data').textContent='Show Sample Leads & Quotes'; }
    }

    function renderSampleData(){
      var leadsEl = document.getElementById('sample-leads');
      var quotesEl = document.getElementById('sample-quotes');
      if(!leadsEl || !quotesEl) return;
      var data = window.QUICK_SALES_DATA || {leads:[],quotes:[]};
      // render leads table
      var html = '<table style="width:100%;border-collapse:collapse"><thead><tr><th style="text-align:left;padding:6px;border-bottom:1px solid var(--rw-border)">ID</th><th style="text-align:left;padding:6px;border-bottom:1px solid var(--rw-border)">Account</th><th style="text-align:left;padding:6px;border-bottom:1px solid var(--rw-border)">Contact</th><th style="text-align:left;padding:6px;border-bottom:1px solid var(--rw-border)">Status</th></tr></thead><tbody>';
      data.leads.forEach(function(l){ html += '<tr><td style="padding:6px;border-bottom:1px solid #eee">'+l.id+'</td><td style="padding:6px;border-bottom:1px solid #eee">'+l.account+'</td><td style="padding:6px;border-bottom:1px solid #eee">'+l.contact+'</td><td style="padding:6px;border-bottom:1px solid #eee">'+l.status+'</td></tr>'; });
      html += '</tbody></table>';
      leadsEl.innerHTML = html;
      // render quotes table
      var qhtml = '<table style="width:100%;border-collapse:collapse"><thead><tr><th style="text-align:left;padding:6px;border-bottom:1px solid var(--rw-border)">ID</th><th style="text-align:left;padding:6px;border-bottom:1px solid var(--rw-border)">Account</th><th style="text-align:left;padding:6px;border-bottom:1px solid var(--rw-border)">Ref</th><th style="text-align:right;padding:6px;border-bottom:1px solid var(--rw-border)">Amount</th><th style="text-align:left;padding:6px;border-bottom:1px solid var(--rw-border)">Status</th></tr></thead><tbody>';
      data.quotes.forEach(function(q){ qhtml += '<tr><td style="padding:6px;border-bottom:1px solid #eee">'+q.id+'</td><td style="padding:6px;border-bottom:1px solid #eee">'+q.account+'</td><td style="padding:6px;border-bottom:1px solid #eee">'+q.ref+'</td><td style="padding:6px;border-bottom:1px solid #eee;text-align:right">$'+(q.amount||0).toLocaleString()+'</td><td style="padding:6px;border-bottom:1px solid #eee">'+q.status+'</td></tr>'; });
      qhtml += '</tbody></table>';
      quotesEl.innerHTML = qhtml;
    }
    function presetQuickSales(){
      // Just preview behavior: show a confirmation message only
      alert('Quick Sales demo state applied.');
    }
  </script>

  <!-- Quick Sales detail modals (in-page) -->
  <div id="qs-modals" style="display:none">
    <style>
      .qs-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.45);display:flex;align-items:center;justify-content:center;z-index:60}
      .qs-modal{width:min(760px,94%);background:var(--rw-surface);border-radius:12px;padding:18px;border:1px solid var(--rw-border);box-shadow:0 8px 24px rgba(2,6,23,.3)}
      .qs-modal h2{margin-top:0}
      .qs-actions{display:flex;gap:8px;justify-content:flex-end;margin-top:12px}
    </style>

    <div id="qs-modal-1" class="qs-overlay" style="display:none" aria-hidden="true">
      <div class="qs-modal" role="dialog" aria-modal="true" aria-labelledby="qs1-title" tabindex="-1">
        <h2 id="qs1-title">Account + Need Confirmation</h2>
        <p>Validate the existing relationship, confirm scope, and document the expansion trigger. Pick an account, review recent projects, and capture the expansion reason.</p>
        <h4>Example Fields</h4>
        <ul>
          <li>Account selector (search + favorites)</li>
          <li>Recent project history summary</li>
          <li>Primary contact verification</li>
          <li>Expansion trigger (capex, maintenance, regulation)</li>
        </ul>
        <div class="qs-actions">
          <button type="button" class="btn" onclick="closeQuickModal(1)">Close</button>
          <button type="button" class="btn primary" id="qs1-yes" onclick="confirmAccount(true)">Yes</button>
          <button type="button" class="btn" id="qs1-no" onclick="confirmAccount(false)">No</button>
          <button type="button" class="btn" onclick="nextQuickStep(1)">Next</button>
        </div>
      </div>
    </div>

    <div id="qs-modal-2" class="qs-overlay" style="display:none" aria-hidden="true">
      <div class="qs-modal" role="dialog" aria-modal="true" aria-labelledby="qs2-title" tabindex="-1">
        <h2 id="qs2-title">Pre-Built Quote & Approval</h2>
        <p>Launch the Quick Quote path with embedded controls, auto-attach documentation, and route fast approvals. Use this screen to pick a price template and submit for approval.</p>
        <h4>Example Controls</h4>
        <ul>
          <li>Price template selector</li>
          <li>Auto-attach supporting documents</li>
          <li>Approval routing (fast lanes)</li>
          <li>Review & submit button</li>
        </ul>
        <div class="qs-actions">
          <button type="button" class="btn" onclick="showQuickModal(1)">Back</button>
          <button type="button" class="btn" onclick="closeQuickModal(2)">Close</button>
          <button type="button" class="btn" id="qs2-check" onclick="checkQuote()">Check Quote</button>
          <button type="button" class="btn" id="qs2-approve-yes" onclick="approveQuote(true)" disabled>Approve: Yes</button>
          <button type="button" class="btn" id="qs2-approve-no" onclick="approveQuote(false)" disabled>Approve: No</button>
          <button type="button" class="btn" onclick="nextQuickStep(2)">Next</button>
        </div>
      </div>
    </div>

    <div id="qs-modal-3" class="qs-overlay" style="display:none" aria-hidden="true">
      <div class="qs-modal" role="dialog" aria-modal="true" aria-labelledby="qs3-title" tabindex="-1">
        <h2 id="qs3-title">Execution & Handoff</h2>
        <p>Convert to an opportunity with the required artifacts attached, then hand off to delivery without re-keying. This simulates conversion and PPM handoff.</p>
        <h4>Example Actions</h4>
        <ul>
          <li>Convert quick quote into opportunity</li>
          <li>Attach proposal and project artifacts</li>
          <li>Run integration to PPM (OIC job)</li>
          <li>Notify delivery and create pursuit record</li>
        </ul>
        <div class="qs-actions">
          <button type="button" class="btn" onclick="showQuickModal(2)">Back</button>
          <button type="button" class="btn" onclick="closeQuickModal(3)">Close</button>
          <button type="button" class="btn" onclick="convertOpportunity()">Convert Opportunity</button>
          <button type="button" class="btn" onclick="pushToCPQ()">Push to CPQ</button>
          <button type="button" class="btn primary" onclick="pushToPursuit()">Push to Pursuit</button>
        </div>
      </div>
    </div>
  </div>

    <script defer src="assets/modal.js"></script>
    <script>
      function startInteractiveFlow(){
        if(typeof showQuickModal==='function'){
          try{ showQuickModal(1); return; }catch(e){}
        }
        // Fallback: create a small inline overlay with the 3-stage buttons
        createFallbackFlow();
      }

      function createFallbackFlow(){
        if(document.getElementById('qs-fallback-overlay')) return;
        var last = document.activeElement;
        var overlay = document.createElement('div');
        overlay.id = 'qs-fallback-overlay';
        overlay.style.position = 'fixed';
        overlay.style.inset = '0';
        overlay.style.background = 'rgba(0,0,0,0.45)';
        overlay.style.display = 'flex';
        overlay.style.alignItems = 'center';
        overlay.style.justifyContent = 'center';
        overlay.style.zIndex = 120;

        var dialog = document.createElement('div');
        dialog.id = 'qs-fallback-dialog';
        dialog.setAttribute('role','dialog');
        dialog.setAttribute('aria-modal','true');
        dialog.setAttribute('aria-labelledby','qs-fallback-title');
        dialog.tabIndex = -1;
        dialog.style.width = 'min(520px,94%)';
        dialog.style.maxWidth = '520px';
        dialog.style.background = 'var(--rw-surface, #fff)';
        dialog.style.border = '1px solid var(--rw-border, #ddd)';
        dialog.style.borderRadius = '10px';
        dialog.style.boxShadow = '0 12px 36px rgba(2,6,23,.28)';
        dialog.style.padding = '14px';

        dialog.innerHTML = '<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px"><strong id="qs-fallback-title">Quick Sales Flow</strong><button type="button" aria-label="Close fallback" style="background:transparent;border:0;font-size:20px;cursor:pointer" onclick="removeFallbackFlow()">×</button></div>'+
          '<div style="font-size:0.95em;margin-bottom:12px">Step through the condensed 3-stage progression.</div>'+
          '<div style="display:flex;flex-direction:column;gap:8px">'+
            '<button type="button" class="btn" id="fb-1" onclick="(function(){ if(typeof showQuickModal==\'function\'){ showQuickModal(1); removeFallbackFlow(); } else { confirmAccount(true); removeFallbackFlow(); } })()">1. Account: Yes</button>'+
            '<button type="button" class="btn" id="fb-2" onclick="(function(){ if(typeof showQuickModal==\'function\'){ showQuickModal(2); removeFallbackFlow(); } else { checkQuote(); removeFallbackFlow(); } })()">2. Quote: Check</button>'+
            '<button type="button" class="btn primary" id="fb-3" onclick="(function(){ if(typeof showQuickModal==\'function\'){ showQuickModal(3); removeFallbackFlow(); } else { convertOpportunity(); removeFallbackFlow(); } })()">3. Convert / Handoff</button>'+
          '</div>';

        overlay.appendChild(dialog);
        document.body.appendChild(overlay);
        // focus management + ESC to close
        setTimeout(function(){
          var f = dialog.querySelector('button, [tabindex]');
          if(f) f.focus(); else dialog.focus();
        }, 40);
        function onKey(e){ if(e.key==='Escape' || e.key==='Esc'){ removeFallbackFlow(); } }
        overlay._onKey = onKey;
        document.addEventListener('keydown', onKey);
        overlay._lastFocused = last;
      }

      function removeFallbackFlow(){
        var overlay = document.getElementById('qs-fallback-overlay');
        if(!overlay) return;
        try{ if(overlay._onKey) document.removeEventListener('keydown', overlay._onKey); }catch(e){}
        var last = overlay._lastFocused;
        overlay.parentNode.removeChild(overlay);
        try{ if(last && typeof last.focus==='function') last.focus(); }catch(e){}
      }

      // Stage 1: Yes/No handler
      function confirmAccount(choice){
        try{
          var msg = choice ? 'Account & Need CONFIRMED' : 'Account & Need NOT confirmed';
          if(window.RWD && typeof RWD.get==='function'){
            var s = RWD.get(); s.logs = s.logs || [];
            s.logs.unshift('['+new Date().toLocaleString()+'] Quick Sales Stage1: '+msg);
            if(typeof RWD.set==='function') RWD.set(s);
          }
        }catch(e){console.warn(e)}
        if(typeof showToast==='function') showToast(msg); else alert(msg);
        // optionally mark lead qualified on Yes
        if(choice && window.RWD && typeof RWD.updateSalesFlow==='function'){
          RWD.updateSalesFlow('lead','Qualified','Quick Sales Stage 1: Account confirmed');
        }
      }

      // Stage 2: Check quote then enable approve
      function checkQuote(){
        var btnCheck = document.getElementById('qs2-check');
        var yes = document.getElementById('qs2-approve-yes');
        var no = document.getElementById('qs2-approve-no');
        if(btnCheck) btnCheck.textContent = 'Checking...';
        setTimeout(function(){
          if(btnCheck) btnCheck.textContent = 'Check Quote';
          if(yes) yes.disabled = false; if(no) no.disabled = false;
          try{ var s = RWD.get(); s.logs = s.logs || []; s.logs.unshift('['+new Date().toLocaleString()+'] Quick Sales Stage2: Quote checked'); if(typeof RWD.set==='function') RWD.set(s); }catch(e){}
          if(typeof showToast==='function') showToast('Quote check completed — you can Approve Yes/No'); else alert('Quote check completed — you can Approve Yes/No');
        }, 700);
      }

      function approveQuote(approved){
        try{
          var msg = approved ? 'Quote APPROVED' : 'Quote NOT approved';
          if(window.RWD && typeof RWD.get==='function'){
            var s = RWD.get(); s.logs = s.logs || [];
            s.logs.unshift('['+new Date().toLocaleString()+'] Quick Sales Stage2: '+msg);
            if(typeof RWD.set==='function') RWD.set(s);
          }
        }catch(e){}
        if(typeof showToast==='function') showToast(msg); else alert(msg);
        if(approved && window.RWD && typeof RWD.updateSalesFlow==='function'){
          RWD.updateSalesFlow('quote','Approved','Quick Sales Stage 2: Quote approved');
        }
      }

      // Stage 3 actions
      function convertOpportunity(){
        try{ if(window.RWD && typeof RWD.updateSalesFlow==='function'){ RWD.updateSalesFlow('opportunity','Closed Won','Quick Sales Stage 3: Converted via Quick Sales'); } }catch(e){}
        if(typeof showToast==='function') showToast('Opportunity converted (demo state updated)'); else alert('Opportunity converted (demo state updated)');
      }

      function pushToCPQ(){
        try{ if(window.RWD && typeof RWD.runOICJob==='function'){ RWD.runOICJob('Push to CPQ'); } else { var s=RWD.get(); s.logs=s.logs||[]; s.logs.unshift('['+new Date().toLocaleString()+'] Quick Sales Stage3: Push to CPQ simulated'); if(typeof RWD.set==='function') RWD.set(s);} }catch(e){}
        if(typeof showToast==='function') showToast('Push to CPQ simulated'); else alert('Push to CPQ simulated');
      }

      function pushToPursuit(){
        try{
          if(window.RWD && typeof RWD.createPursuitViaOIC==='function'){
            RWD.createPursuitViaOIC(function(){ if(typeof showToast==='function') showToast('Pursuit created via OIC (demo state updated)'); else alert('Pursuit created via OIC (demo state updated)'); });
          } else {
            if(window.RWD && typeof RWD.get==='function'){ var s=RWD.get(); s.logs=s.logs||[]; s.logs.unshift('['+new Date().toLocaleString()+'] Quick Sales Stage3: Push to Pursuit simulated'); if(typeof RWD.set==='function') RWD.set(s); }
            if(typeof showToast==='function') showToast('Push to Pursuit simulated'); else alert('Push to Pursuit simulated');
          }
        }catch(e){}
      }
    </script>


<div class="footer">© Demo – Redwood-inspired mockup</div></div>
</body>
</html>
