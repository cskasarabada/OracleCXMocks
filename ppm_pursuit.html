<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>PPM Pursuit (Redwood)</title>
<link rel="stylesheet" href="assets/redwood.css"/>
<script defer src="assets/app.js"></script>
</head>
<body>
<header class="miconnex-bar">
  <div class="logo-mark">
    <span class="logo-icon argano">A</span>
    <div>
      <div class="logo-text">Argano</div>
      <div class="logo-sub">Connected Cloud</div>
    </div>
  </div>
  <div class="bar-actions">
    <button class="ghost-btn small">Help</button>
    <button class="ghost-btn small">Support</button>
    <div class="avatar-chip">CK</div>
  </div>
</header>
<nav class="quick-nav auto-nav">
  <div class="nav-group">
    <div class="nav-label">Sales &amp; Delivery Journey</div>
    <div class="nav-items">
      <a href="index.html">Overview</a>
      <a href="Easy_Start_Flows.html">Easy Start</a>
      <a href="sales_cloud.html">Sales Flow</a>
      <a href="sales_tools.html">Sales Tools</a>
      <a href="cx_lead.html">Lead</a>
      <a href="cx_opportunity.html">Opportunity</a>
      <a class="active" href="ppm_pursuit.html">PPM Pursuit</a>
      <a href="ppm_construction.html">PPM Construction</a>
      <a class="accent" href="quick_sales_screen.html">Quick Sales Screen</a>
    </div>
  </div>
  <div class="nav-group">
    <div class="nav-label">Insights &amp; Toolkit</div>
    <div class="nav-items">
      <a href="analytics.html">Analytics</a>
      <a href="forecasting_pipeline.html">Forecasting</a>
      <a href="integration_features.html">Integration</a>
      <a href="sales_process_visualization.html">Process Visualization</a>
      <a href="results_driven.html">Results Driven</a>
      <a href="executive_command_center.html">Exec Command</a>
      <a href="account_360.html">Account 360</a>
      <a href="partner_hub.html">Partner Hub</a>
      <a href="revenue_intelligence.html">Revenue Intelligence</a>
      <a href="field_mobile_snapshot.html">Field Mobile</a>
      <a href="sales_ppm_sync.html">Sales-PPM</a>
      <a href="quote_to_docusign.html">Quote to DocuSign</a>
      <a href="pursuit_project.html">Pursuit Project</a>
    </div>
  </div>
</nav>



<div class="shell">

<div class="grid">
  <div class="card"><h2>PPM Pursuit</h2><div class="body">
    <form id="purForm">
      <div class="row">
        <div><label>Project Name<input name="name" id="purName"></label></div>
        <div><label>Estimate (USD)<input name="estimate" id="purEstimate" type="number"></label></div>
      </div>
      <div class="actions">
        <button class="btn ok" id="btnAward">Award / Create Construction (OIC)</button>
        <a class="btn" href="cx_opportunity.html">Back</a>
      </div>
    </form>
  </div></div>
  <div class="card"><h2>Status</h2><div class="body">
    <div class="kv"><div class="k">State</div><div class="v" id="purState">Draft</div></div>
    <div class="progress"><div class="bar" id="purProg"></div></div>
  </div></div>
</div>
<section class="smart-banner" id="pursuit-smart-banner">
  <div>
    <p class="eyebrow">Smart Actions</p>
    <h3>Keep pursuit tasks moving</h3>
    <p>Trigger estimating, resource requests, and integration syncs for <strong id="pursuit-smart-name">this pursuit</strong>.</p>
  </div>
  <div class="actions">
    <div class="pill-row">
      <button type="button" class="btn" data-pursuit-action="Request Estimate">Request Estimate</button>
      <button type="button" class="btn" data-pursuit-action="Assign Resources">Assign Resources</button>
      <button type="button" class="btn" data-pursuit-action="Sync to CX">Sync to CX</button>
      <button type="button" class="btn" data-pursuit-action="Share Status">Share Status</button>
    </div>
    <div class="action-block">
      <label class="visually-hidden" for="pursuit-smart-select">Smart Actions</label>
      <select id="pursuit-smart-select">
        <option value="">- Select Smart Action -</option>
        <option value="Request Estimate">Request Estimate</option>
        <option value="Assign Resources">Assign Resources</option>
        <option value="Sync to CX">Sync to CX</option>
        <option value="Share Status">Share Status</option>
        <option value="Trigger Doc Review">Trigger Doc Review</option>
      </select>
      <button type="button" class="btn" id="pursuit-smart-apply">Apply</button>
    </div>
  </div>
</section>
<script>
 window.addEventListener('DOMContentLoaded', function(){
  var d=RWD.get();
  document.getElementById('purName').value=d.pursuit.name||'';
  document.getElementById('purEstimate').value=d.pursuit.estimate||0;
  var smartLabel=document.getElementById('pursuit-smart-name'); if(smartLabel) smartLabel.textContent=d.pursuit.name||'this pursuit';
  document.getElementById('purState').textContent=d.pursuit.status || 'Draft';
  document.getElementById('purProg').style.width=(d.pursuit.status==='Awarded'? '100%' : '40%');
  initPursuitSmartBanner();
  document.getElementById('btnAward').addEventListener('click', function(e){
     e.preventDefault();
     RWD.savePursuit(document.getElementById('purForm'));
     document.getElementById('purState').textContent='Award in progress…';
     document.getElementById('purProg').style.width='60%';
     RWD.awardToConstruction(function(){
       document.getElementById('purState').textContent='Awarded';
       document.getElementById('purProg').style.width='100%';
       setTimeout(function(){ window.location='ppm_construction.html'; }, 600);
     });
 });
});
function initPursuitSmartBanner(){
  var buttons=document.querySelectorAll('[data-pursuit-action]');
  buttons.forEach(function(btn){
    btn.addEventListener('click', function(){ firePursuitAction(btn.dataset.pursuitAction || btn.textContent); });
  });
  var select=document.getElementById('pursuit-smart-select');
  var apply=document.getElementById('pursuit-smart-apply');
  if(apply){ apply.addEventListener('click', function(){ if(select) firePursuitAction(select.value); }); }
}
function firePursuitAction(action){
  if(!action) return;
  var handled=openPursuitActionModal(action);
  if(window.RWD && typeof RWD.actPursuit==='function'){ RWD.actPursuit(action); }
  if(!handled && typeof showToast==='function') showToast(action+' triggered');
}

function openPursuitActionModal(action){
  var modal=document.getElementById('pursuit-action-modal');
  if(!modal) return false;
  var forms=modal.querySelectorAll('[data-pursuit-form]');
  var found=false;
  forms.forEach(function(form){
    var show=form.dataset.pursuitForm===action;
    form.style.display=show?'flex':'none';
    if(show){
      found=true;
      prefillPursuitAction(form);
      setTimeout(function(){ var first=form.querySelector('input,textarea,select'); if(first) first.focus(); }, 30);
    }
  });
  if(!found) return false;
  var title=document.getElementById('pursuitActionTitle'); if(title) title.textContent=action;
  modal.style.display='flex';
  modal.setAttribute('aria-hidden','false');
  document.body.classList.add('modal-visible');
  return true;
}

function closePursuitAction(){
  var modal=document.getElementById('pursuit-action-modal');
  if(!modal) return;
  modal.style.display='none';
  modal.setAttribute('aria-hidden','true');
  document.body.classList.remove('modal-visible');
}

function prefillPursuitAction(form){
  var state=(window.RWD && typeof RWD.get==='function')?(function(){ try{return RWD.get();}catch(e){ return {}; } })():{};
  var pursuit=state.pursuit||{};
  if(form.dataset.pursuitForm==='Request Estimate'){
    if(form.elements.scope && !form.elements.scope.value){ form.elements.scope.value=(pursuit.name||'Pursuit')+' estimate'; }
  }
  if(form.dataset.pursuitForm==='Sync to CX'){
    if(form.elements.syncMessage && !form.elements.syncMessage.value){ form.elements.syncMessage.value='Sharing '+(pursuit.name||'pursuit')+' status to CX'; }
  }
  if(form.dataset.pursuitForm==='Share Status'){
    if(form.elements.statusSummary && !form.elements.statusSummary.value){ form.elements.statusSummary.value='Status '+(pursuit.status||'Draft'); }
  }
  if(form.dataset.pursuitForm==='Trigger Doc Review'){
    if(form.elements.docName && !form.elements.docName.value){ form.elements.docName.value=(pursuit.name||'Pursuit')+' SOW'; }
  }
}

function submitPursuitAction(ev){
  if(ev) ev.preventDefault();
  var form=ev?ev.target:null;
  if(!form) return false;
  var action=form.dataset.pursuitForm || 'Action';
  switch(action){
    case 'Request Estimate':
      if(window.RWD && typeof RWD.runOICJob==='function'){ try{ RWD.runOICJob('Estimate request'); }catch(e){} }
      if(typeof showToast==='function') showToast('Estimate requested');
      break;
    case 'Assign Resources':
      if(typeof showToast==='function') showToast('Resources assigned');
      break;
    case 'Sync to CX':
      if(window.RWD && typeof RWD.runOICJob==='function'){ try{ RWD.runOICJob('Sync pursuit to CX'); }catch(e){} }
      if(typeof showToast==='function') showToast('Pursuit synced to CX');
      break;
    case 'Share Status':
      if(typeof showToast==='function') showToast('Status shared to team');
      break;
    case 'Trigger Doc Review':
      if(window.RWD && typeof RWD.runOICJob==='function'){ try{ RWD.runOICJob('Doc review'); }catch(e){} }
      if(typeof showToast==='function') showToast('Doc review triggered');
      break;
    default:
      if(typeof showToast==='function') showToast(action+' completed');
  }
  form.reset();
  closePursuitAction();
  return false;
}
</script>
<div class="footer">© Demo – Redwood-inspired mockup</div></div>
</body>
</html>

