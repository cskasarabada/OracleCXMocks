<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Argano Opportunity</title>
<link rel="stylesheet" href="https://static.oracle.com/cdn/jet/18.1.0-2510.4/default/css/redwood/oj-redwood-min.css" id="oj-redwood-cdn" type="text/css" />
<link rel="stylesheet" href="assets/redwood.css" />
<link rel="stylesheet" href="assets/vbcs-shared.css" />
<script defer src="assets/app.js"></script>
<style>
.oppty-oracle-hero{background:#fff;border-radius:22px;border:1px solid rgba(27,38,56,.1);box-shadow:0 28px 40px rgba(12,18,30,.14);padding:26px;margin-bottom:26px;}
.oppty-oracle-hero h1{margin:0;font-size:1.9rem;}
.oppty-oracle-hero .meta-row{display:flex;gap:10px;flex-wrap:wrap;margin-top:8px;}
.oppty-oracle-hero .hero-details{display:flex;gap:20px;flex-wrap:wrap;font-size:13px;color:#5a6478;margin-top:12px;}
.oppty-oracle-hero .hero-search{display:flex;gap:12px;flex-wrap:wrap;margin-top:18px;}
.oppty-oracle-hero input[type="search"]{flex:1;min-width:260px;border-radius:10px;border:1px solid rgba(27,38,56,.18);padding:11px;font-size:15px;}
.oppty-ai-summary{background:#fff;border-radius:18px;border:1px solid rgba(27,38,56,.08);box-shadow:0 18px 32px rgba(10,15,24,.12);padding:20px;margin-bottom:28px;}
.oppty-ai-summary h3{margin:0 0 8px;font-size:1.1rem;}
.oppty-ai-summary p{margin:0;font-size:14px;color:#475467;}
.oppty-ai-summary .ai-actions{display:flex;gap:12px;margin-top:12px;flex-wrap:wrap;}
.oppty-ai-summary .ai-pill{background:#f5f0e7;border-radius:10px;padding:6px 12px;border:1px solid rgba(34,45,60,.2);font-size:12px;font-weight:600;}
.oppty-summary-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:14px;margin-top:18px;}
.oppty-summary-card{background:#fff;border-radius:16px;border:1px solid rgba(27,38,56,.1);padding:14px;box-shadow:0 14px 26px rgba(15,23,42,.08);}
.oppty-summary-card .label{text-transform:uppercase;letter-spacing:.12em;font-size:11px;color:#6c7894;}
.oppty-summary-card .value{font-size:1.7rem;font-weight:700;margin:4px 0;}
.oppty-summary-card p{margin:0;font-size:13px;color:#5d6478;}
.analytics-deck{background:linear-gradient(135deg,#0d1b2e,#0f2438 58%,#12324d);color:#e8eef7;border-radius:18px;padding:22px;box-shadow:0 20px 38px rgba(6,16,36,.28);margin-bottom:26px;border:1px solid rgba(255,255,255,.08);}
.analytics-deck h2{margin:4px 0 6px;font-size:1.6rem;}
.analytics-deck .deck-desc{margin:0;color:#c6d4eb;max-width:680px;font-size:14px;}
.analytics-deck .deck-header{display:flex;justify-content:space-between;gap:18px;flex-wrap:wrap;align-items:flex-start;}
.analytics-deck .deck-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:12px;margin-top:16px;}
.analytics-tile{background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.08);border-radius:14px;padding:12px;box-shadow:0 10px 20px rgba(0,0,0,.16);}
.analytics-tile .label{color:#9fb8d8;font-size:12px;letter-spacing:.08em;text-transform:uppercase;}
.analytics-tile .value{font-size:1.5rem;font-weight:700;margin:6px 0;}
.analytics-tile .meta{margin:0;color:#dfe7f4;font-size:13px;}
.story-anchors{margin-top:14px;background:rgba(255,255,255,.06);border:1px solid rgba(255,255,255,.1);border-radius:14px;padding:14px;}
.story-anchors .anchor-head{display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:10px;}
.story-anchors .chips{display:flex;gap:8px;flex-wrap:wrap;}
.story-anchors .chip{background:rgba(255,255,255,.1);border:1px solid rgba(255,255,255,.2);padding:6px 10px;border-radius:999px;font-size:12px;color:#f1f6ff;}
.story-anchors .anchor-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:10px;margin-top:12px;}
.anchor-card{background:#0a182b;border:1px solid rgba(255,255,255,.12);border-radius:12px;padding:12px;box-shadow:0 12px 18px rgba(0,0,0,.22);}
.anchor-card .label{color:#9fb8d8;font-size:12px;text-transform:uppercase;letter-spacing:.08em;}
.anchor-card .name{margin:4px 0;font-size:1rem;font-weight:700;}
.anchor-card .detail{margin:0;color:#dce6f3;font-size:13px;}
.vision-footer{position:fixed;bottom:0;left:0;right:0;background:#241a37;color:#fff;display:flex;justify-content:center;gap:16px;padding:10px 12px;box-shadow:0 -8px 24px rgba(12,18,32,.24);z-index:3800;border-top:1px solid rgba(255,255,255,.08);}
.vision-footer a{color:#e5e7eb;text-decoration:none;font-weight:700;font-size:14px;padding:8px 12px;border-radius:10px;transition:background 120ms ease,color 120ms ease;}
.vision-footer a:hover{background:rgba(255,255,255,.08);}
.vision-footer a.active{background:#f97316;color:#0b1324;}
</style>
</head>
<body class="lead-landing oracle-fusion-skin">
<header class="miconnex-bar">
  <div class="logo-mark">
    <span class="logo-icon argano">A</span>
    <div>
      <div class="logo-text">Argano</div>
      <div class="logo-sub">Connected Cloud</div>
    </div>
  </div>
  <div class="bar-actions">
    <div class="persona-dropdown">
      <label>Persona</label>
      <select class="persona-select">
        <option value="all">All Persona</option>
        <option value="rep">Sales Rep</option>
        <option value="manager">Sales Manager</option>
        <option value="exec">Executive</option>
        <option value="delivery">Delivery</option>
        <option value="partner">Partner</option>
      </select>
    </div>

    <button class="ghost-btn small">Help</button>
    <button class="ghost-btn small">Support</button>
    <div class="avatar-chip">CK</div>
  </div>
</header>
<nav class="quick-nav auto-nav">
  <div class="nav-group">
    <div class="nav-label">Sales &amp; Delivery Journey</div>
    <div class="nav-items">    <a href="index.html">Overview</a>    <a href="Easy_Start_Flows.html">Easy Start</a>    <a href="sales_cloud.html">Sales Flow</a>    <a href="sources.html">Lead Gen (3rd Party Sources)</a>    <a href="cx_lead.html">Lead</a>
      <a href="cx_opportunity.html" class="active">Opportunity</a>    <a href="my_team.html">My Team</a>    <a href="sales_tools.html">Sales Tools</a>    <a href="ppm_pursuit.html">PPM Pursuit</a>    <a href="ppm_construction.html">PPM Construction</a>
      <a href="quick_sales_screen.html" class="accent">Quick Sales Screen</a>
    </div>
  </div>
  <div class="nav-group">
    <div class="nav-label">Insights &amp; Toolkit</div>
    <div class="nav-items">    <a href="analytics.html">Analytics</a>    <a href="forecasting_pipeline.html">Forecasting</a>    <a href="integration_features.html">Integration</a>    <a href="sales_process_visualization.html">Process Visualization</a>    <a href="results_driven.html">Results Driven</a>    <a href="executive_command_center.html">Exec Command</a>    <a href="account_360.html">Account 360</a>    <a href="partner_hub.html">Partner Hub</a>    <a href="revenue_intelligence.html">Revenue Intelligence</a>    <a href="field_mobile_snapshot.html">Field Mobile</a>    <a href="sales_ppm_sync.html">Sales-PPM</a>    <a href="quote_to_docusign.html">Quote to DocuSign</a>    <a href="pursuit_project.html">Pursuit Project</a>
    </div>
  </div>
</nav>
<main class="oppty-shell">
  <section class="oppty-oracle-hero">
    <p class="eyebrow">Lead Gen &rarr; Lead &rarr; Opportunity</p>
    <h1 id="opptyHeroTitle">Opportunity Workspace</h1>
    <div class="meta-row">
      <span class="pill">Account Warner Design Associates</span>
      <span class="pill">Owner Chandra Kasarabada</span>
      <span class="pill">Stage Qualification</span>
      <span class="pill">ARR Target $1.2M</span>
    </div>
    <div class="hero-details">
      <div>Primary Contact <strong id="opptyHeroSub">Account &middot; Primary Contact</strong></div>
      <div>Close Date <strong>Nov 30, 2024</strong></div>
      <div>Win Probability <strong>40%</strong></div>
    </div>
    <div class="hero-search">
      <input type="search" placeholder="Ask Oracle GenAI to summarize this opportunity" id="opptyAiInput"/>
      <button class="btn primary" onclick="return runOpptyAISummary('overview');">Summarize Opportunity</button>
      <div class="ai-pill">AI ready &middot; Nudges available</div>
    </div>
    <div class="oppty-search-results" id="opptySearchResults" aria-live="polite" aria-atomic="true" hidden></div>
    <div class="oppty-summary-grid">
      <div class="oppty-summary-card">
        <div class="label">Amount</div>
        <div class="value" id="opptyAmountCard">$1,200,000</div>
        <p>Includes services and subscription uplift.</p>
      </div>
      <div class="oppty-summary-card">
        <div class="label">Next Milestone</div>
        <div class="value">DocuSign</div>
        <p>Needs executive approval + partner review.</p>
      </div>
      <div class="oppty-summary-card">
        <div class="label">Last Touch</div>
        <div class="value">Oct 18</div>
        <p>Email prep with solution architect.</p>
      </div>
    </div>
  </section>

  <section class="oppty-ai-summary">
    <h3>Oracle GenAI Guidance</h3>
    <p id="opptyAiSummaryText">Use AI to highlight opportunity context, risks, or clever Smart Actions.</p>
    <div class="ai-actions">
      <button class="btn brand" onclick="return runOpptyAISummary('overview');">Overview</button>
      <button class="btn" onclick="return runOpptyAISummary('risk');">Risks & Signals</button>
      <button class="btn" onclick="return runOpptyAISummary('action');">Smart Actions</button>
    </div>
  </section>
  <section class="analytics-deck" id="analytics-command-deck">
    <div class="deck-header">
      <div>
        <p class="eyebrow" style="color:#c6d4eb">Oracle CX Sales Cloud</p>
        <h2>Analytics Command Deck</h2>
        <p class="deck-desc">Bring the Argano storytelling layer to life with dashboards that span Leads, Opportunities, Quotes, Pursuits, Projects, Accounts, and Customers—each curated to show how CX Sales, CPQ, and PPM tie together.</p>
      </div>
    </div>
    <div class="deck-grid">
      <div class="analytics-tile">
        <div class="label">Leads Velocity</div>
        <div class="value">+18%</div>
        <p class="meta">Cycle time shortening across nurtured leads.</p>
      </div>
      <div class="analytics-tile">
        <div class="label">Opportunity Health</div>
        <div class="value">72%</div>
        <p class="meta">Risk-adjusted win score across open pipeline.</p>
      </div>
      <div class="analytics-tile">
        <div class="label">Quote Controls</div>
        <div class="value">6 in-flight</div>
        <p class="meta">Active approvals + DocuSign tracking.</p>
      </div>
      <div class="analytics-tile">
        <div class="label">Pursuit Burn</div>
        <div class="value">$325K</div>
        <p class="meta">Spend versus budget with OIC sync.</p>
      </div>
      <div class="analytics-tile">
        <div class="label">Project Pulse</div>
        <div class="value">On-track</div>
        <p class="meta">Delivery health fed from PPM projects.</p>
      </div>
      <div class="analytics-tile">
        <div class="label">Customer Signals</div>
        <div class="value">9 alerts</div>
        <p class="meta">Renewal + adoption cues surfaced by AI.</p>
      </div>
    </div>
    <div class="story-anchors">
      <div class="anchor-head">
        <div>
          <p class="label" style="color:#9fb8d8">Live Story Anchors</p>
          <div class="chips">
            <span class="chip">Lead</span>
            <span class="chip">Opportunity</span>
            <span class="chip">Pursuit</span>
            <span class="chip">Project</span>
            <span class="chip">Customer</span>
          </div>
        </div>
      </div>
      <div class="anchor-grid">
        <div class="anchor-card">
          <div class="label">Lead</div>
          <div class="name">Skyline Renewables</div>
          <p class="detail">Score 78 · GenAI nudges ready</p>
        </div>
        <div class="anchor-card">
          <div class="label">Opportunity</div>
          <div class="name">Skyline Microgrid Modernization</div>
          <p class="detail">$1,250,000 · DocuSign next</p>
        </div>
        <div class="anchor-card">
          <div class="label">Pursuit</div>
          <div class="name">Skyline Microgrid Modernization - Pursuit</div>
          <p class="detail">Draft · OIC handoff in-flight</p>
        </div>
        <div class="anchor-card">
          <div class="label">Project</div>
          <div class="name">Skyline Microgrid Modernization - Construction</div>
          <p class="detail">$1,287,500 · Tracking burn vs. plan</p>
        </div>
      </div>
    </div>
  </section>
  <section class="smart-banner" id="oppty-smart-banner">
    <div>
      <p class="eyebrow">Smart Actions</p>
      <h3>Coach every opportunity conversation</h3>
      <p>Trigger approvals, next steps, and partner engagement for <strong id="oppty-smart-name">this opportunity</strong>.</p>
    </div>
    <div class="actions">
      <div class="pill-row">
        <button type="button" class="btn" data-oppty-action="Log Call">Log Call</button>
        <button type="button" class="btn" data-oppty-action="Send Quote">Send Quote</button>
        <button type="button" class="btn" data-oppty-action="Request Approval">Request Approval</button>
        <button type="button" class="btn" data-oppty-action="Launch DocuSign">Launch DocuSign</button>
      </div>
      <div class="action-block">
        <label class="visually-hidden" for="oppty-smart-select">Smart Actions</label>
        <select id="oppty-smart-select">
          <option value="">- Select Smart Action -</option>
          <option value="Log Call">Log Call</option>
          <option value="Send Quote">Send Quote</option>
          <option value="Request Approval">Request Approval</option>
          <option value="Launch DocuSign">Launch DocuSign</option>
          <option value="Create Pursuit">Create Pursuit</option>
          <option value="Escalate">Escalate</option>
        </select>
        <button type="button" class="btn" id="oppty-smart-apply">Apply</button>
      </div>
    </div>
  </section>
  <div class="crumbs">
    <div class="crumb-label">My Open Opportunities</div>
    <div class="crumb-actions">
      <button class="ghost-icon" aria-label="Previous opportunity">&larr;</button>
      <button class="ghost-icon" aria-label="Next opportunity">&rarr;</button>
      <button class="btn outline">Details</button>
    </div>
  </div>

  <section class="opps-preview-card">
    <div class="card-header">
      <div>
        <h3>My Open Opportunities</h3>
        <div class="card-sub">Try searching by keyword or add a filter</div>
      </div>
      <span class="results-count" id="opps-count-label">Results</span>
    </div>
    <div id="opps-preview" class="table-shell"></div>
  </section>

  <section class="oppty-hero-slim">
    <div class="oppty-header-row">
      <div>
        <h1 id="opptyHeroTitle">Opportunity Workspace</h1>
        <div class="hero-sub" id="opptyHeroSub">Account &middot; Primary Contact</div>
      </div>
      <div class="hero-actions">
        <button class="ghost-icon">Share</button>
        <button class="ghost-icon">Sync</button>
        <button class="ghost-icon">Email</button>
        <button class="btn primary">Details</button>
      </div>
    </div>
    <div class="oppty-stage-buttons">
      <div class="stage hero-stage">
        <span class="s cur" data-v="Qualification">Statement of Qualification</span>
        <span class="s" data-v="Evaluation">Evaluation</span>
        <span class="s" data-v="Proposal">Proposal</span>
        <span class="s" data-v="Negotiation">Negotiation</span>
        <span class="s" data-v="Closed Won">Closed Won</span>
      </div>
    </div>
    <div class="oppty-info-strip">
      <span>Status Open</span>
      <span>Win Probability 40%</span>
      <span>Account Warner Design Associates Inc.</span>
      <span>Owner Chandra Kasarabada</span>
      <span>Opportunity #42048</span>
    </div>
    <div class="hero-cta" style="margin-top:14px">
      <button class="btn brand" id="add-new-oppty-btn">Create Opportunity</button>
    </div>
  </section>

  <section class="oppty-board">
    <div class="oppty-board-grid">
      <article class="oppty-board-card">
        <h3>Contacts</h3>
        <p>There are no contacts added for this opportunity yet.</p>
        <p class="muted">As contacts are added, you can view them here.</p>
      </article>
      <article class="oppty-board-card">
        <h3>Team</h3>
        <div class="team-card">
          <div class="avatar">CK</div>
          <div>
            <div class="team-name">Chandra Kasarabada</div>
            <div class="team-email">chandra.Kasarabada@argano.com</div>
            <span class="team-chip">Owner</span>
          </div>
        </div>
        <a class="panel-link" href="#">View All Team Members (1)</a>
      </article>
      <article class="oppty-board-card">
        <h3>Project</h3>
        <p>Keep the commercial team aligned with project delivery.</p>
        <button class="btn brand" id="btnCreatePursuit" type="button">Navigate to PPM</button>
        <div class="project-progress">
          <div class="status-pill" id="status">Idle</div>
          <div class="progress"><div class="bar" id="prog"></div></div>
        </div>
      </article>
      <article class="oppty-board-card">
        <h3>Partners</h3>
        <p>There are no partners assigned for this opportunity yet.</p>
        <p class="muted">As partners are assigned, you can view them here.</p>
      </article>
      <article class="oppty-board-card">
        <h3>Competitors</h3>
        <p>There are no competitors identified yet.</p>
        <p class="muted">As competitors are identified, you can view them here and track their threat levels.</p>
      </article>
    </div>
  </section>

  <div class="carousel-dots" role="presentation">
    <span class="dot active"></span>
    <span class="dot"></span>
    <span class="dot"></span>
    <span class="dot"></span>
    <span class="dot"></span>
  </div>

  <div class="sr-only">
    <div class="timeline" id="opptyTl"></div>
  </div>

  <form id="oppForm" class="sr-only">
    <input name="name" id="opptyName"/>
    <input name="amount" id="opptyAmount" type="number"/>
    <input type="hidden" name="stage" id="stageVal" value="Qualification"/>
  </form>

</main>

<nav class="app-nav-rail"><div class="app-nav-items"></div></nav>

<div id="oppty-action-modal" class="lead-overlay" aria-hidden="true">
  <div class="lead-modal-card" role="dialog" aria-modal="true" aria-labelledby="opptyActionTitle" tabindex="-1">
    <div class="lead-modal-header">
      <div>
        <p class="eyebrow">Opportunity Smart Action</p>
        <h2 id="opptyActionTitle">Engage Opportunity</h2>
      </div>
      <button class="ghost-btn small" type="button" onclick="closeOpptyAction()">Close &times;</button>
    </div>
    <div class="lead-action-panels">
      <form class="lead-action-form" data-oppty-form="Log Call" onsubmit="return submitOpptyAction(event)" style="display:none">
        <p class="muted">Capture call highlights and next steps.</p>
        <label>Call Type
          <select name="callType" required>
            <option value="Exec">Executive</option>
            <option value="Solutioning">Solutioning</option>
            <option value="Commercial">Commercial</option>
          </select>
        </label>
        <label>Participants<textarea name="participants" rows="2" placeholder="AE, Architect, CFO..."></textarea></label>
        <label>Summary<textarea name="summary" rows="3" placeholder="Discussed approval path, risks, etc."></textarea></label>
        <label>Next Step<textarea name="nextStep" rows="2" placeholder="Send updated quote with GP adjustments"></textarea></label>
        <div class="dialog-actions">
          <button type="button" class="ghost-btn" onclick="closeOpptyAction()">Cancel</button>
          <button type="submit" class="btn primary">Log Call</button>
        </div>
      </form>

      <form class="lead-action-form" data-oppty-form="Send Quote" onsubmit="return submitOpptyAction(event)" style="display:none">
        <p class="muted">Launch CPQ with a pre-built Quick Quote.</p>
        <label>Quote Name<input name="quoteName" placeholder="Renewal Quote" required></label>
        <label>Amount<input type="number" name="quoteAmount" placeholder="550000" step="1000"></label>
        <label>Notes<textarea name="quoteNotes" rows="3" placeholder="Include change order items and terms"></textarea></label>
        <div class="dialog-actions">
          <button type="button" class="ghost-btn" onclick="closeOpptyAction()">Cancel</button>
          <button type="submit" class="btn primary">Send Quote</button>
        </div>
      </form>

      <form class="lead-action-form" data-oppty-form="Request Approval" onsubmit="return submitOpptyAction(event)" style="display:none">
        <p class="muted">Route a pricing or commercial approval.</p>
        <label>Approval Type
          <select name="approvalType" required>
            <option value="Discount">Discount</option>
            <option value="Contract">Contract Exception</option>
            <option value="Executive">Executive Review</option>
          </select>
        </label>
        <label>Justification<textarea name="justification" rows="3" placeholder="Customer requested accelerated payment terms..."></textarea></label>
        <div class="dialog-actions">
          <button type="button" class="ghost-btn" onclick="closeOpptyAction()">Cancel</button>
          <button type="submit" class="btn primary">Submit Approval</button>
        </div>
      </form>

      <form class="lead-action-form" data-oppty-form="Launch DocuSign" onsubmit="return submitOpptyAction(event)" style="display:none">
        <p class="muted">Send the latest SOW or quote packet for signature.</p>
        <label>Document Name<input name="docName" placeholder="Phase 2 SOW" required></label>
        <label>Signers<textarea name="signers" rows="2" placeholder="Customer CFO, PMO lead..."></textarea></label>
        <label>Message<textarea name="docMessage" rows="3" placeholder="Please review and sign to begin mobilization."></textarea></label>
        <div class="dialog-actions">
          <button type="button" class="ghost-btn" onclick="closeOpptyAction()">Cancel</button>
          <button type="submit" class="btn primary">Launch DocuSign</button>
        </div>
      </form>

      <form class="lead-action-form" data-oppty-form="Create Pursuit" onsubmit="return submitOpptyAction(event)" style="display:none">
        <p class="muted">Push this opportunity to PPM Pursuit via OIC.</p>
        <label>Pursuit Name<input name="pursuitName" placeholder="Apex Tower Pursuit" required></label>
        <label>Budget<input type="number" name="pursuitBudget" placeholder="1250000" step="1000"></label>
        <label>Notes<textarea name="pursuitNotes" rows="3" placeholder="Include risk register and resourcing plan"></textarea></label>
        <div class="dialog-actions">
          <button type="button" class="ghost-btn" onclick="closeOpptyAction()">Cancel</button>
          <button type="submit" class="btn primary">Create Pursuit</button>
        </div>
      </form>

      <form class="lead-action-form" data-oppty-form="Escalate" onsubmit="return submitOpptyAction(event)" style="display:none">
        <p class="muted">Notify leadership and partner teams about blockers.</p>
        <label>Escalation To<input name="escalateTo" placeholder="Regional VP / Partner" required></label>
        <label>Summary<textarea name="escalateSummary" rows="3" placeholder="Need pricing flexibility to beat competitor..."></textarea></label>
        <div class="dialog-actions">
          <button type="button" class="ghost-btn" onclick="closeOpptyAction()">Cancel</button>
          <button type="submit" class="btn primary">Escalate</button>
        </div>
      </form>
    </div>
  </div>
</div>

<div id="add-oppty-modal" class="qs-overlay" style="display:none;position:fixed;inset:0;background:rgba(0,0,0,0.45);align-items:center;justify-content:center;z-index:120" aria-hidden="true">
  <div class="qs-modal lead-modal" role="dialog" aria-modal="true" aria-labelledby="addOpptyTitle" tabindex="-1" style="width:min(820px,95%)">
    <h2 id="addOpptyTitle">Create Opportunity</h2>
    <form id="addOpptyForm" class="oppty-create-grid">
      <label>Opportunity Name
        <input name="name" placeholder="Skyline Expansion" required>
      </label>
      <label>Account
        <input name="account" placeholder="Customer name">
      </label>
      <label>Amount
        <input name="amount" type="number" placeholder="1250000">
      </label>
      <label>Owner
        <input name="owner" placeholder="Opportunity owner">
      </label>
      <label>Stage
        <select name="stage">
          <option>Qualification</option>
          <option>Evaluation</option>
          <option>Proposal</option>
          <option>Negotiation</option>
          <option>Closed Won</option>
          <option>Closed Lost</option>
        </select>
      </label>
      <label>Primary Contact
        <input name="contact" placeholder="Primary contact">
      </label>
      <label>Close Date
        <input name="closeDate" type="date">
      </label>
      <label>Probability (%)
        <input name="probability" type="number" min="0" max="100" placeholder="65">
      </label>
      <label>Notes
        <textarea name="notes" rows="3" placeholder="Add context or next steps"></textarea>
      </label>
      <div class="actions" style="grid-column:1/-1;display:flex;justify-content:flex-end;gap:10px;margin-top:10px;">
        <button type="button" class="btn" onclick="closeAddOppty()">Cancel</button>
        <button type="submit" class="btn primary">Save Opportunity</button>
      </div>
    </form>
  </div>
</div>

<script>
 window.addEventListener('DOMContentLoaded', function(){
   var fallbackState = { oppty:{ activities:[] }, lead:{}, opportunities:[] };
   var hasRWD = !!(window.RWD && typeof window.RWD.get==='function');
  function safeSnapshot(){
    if(!hasRWD) return JSON.parse(JSON.stringify(fallbackState));
    try{
      var snap = RWD.get() || fallbackState;
      snap.oppty = snap.oppty || { activities:[] };
      snap.oppty.activities = snap.oppty.activities || [];
      snap.lead = snap.lead || {};
      snap.opportunities = snap.opportunities || [];
      return snap;
    }catch(err){
      console.warn('RWD.get failed', err);
      return JSON.parse(JSON.stringify(fallbackState));
    }
  }
  var state=safeSnapshot();
  var tl=document.getElementById('opptyTl');
  var stageField=document.getElementById('stageVal');
  function setStage(v){
    if(stageField) stageField.value=v;
    Array.prototype.slice.call(document.querySelectorAll('.stage .s')).forEach(function(sp){ sp.classList.toggle('cur', sp.dataset.v===v); });
  }
  function updateHero(snapshot){
    var data=snapshot||state||fallbackState;
    data.oppty = data.oppty || {};
    data.lead = data.lead || {};
    var nameField=document.getElementById('opptyName');
    if(nameField) nameField.value=data.oppty.name||'';
    var amtField=document.getElementById('opptyAmount');
    if(amtField) amtField.value=data.oppty.amount||0;
    try{
      var hero = document.getElementById('opptyHeroTitle');
      if(hero) hero.textContent = data.oppty.name || 'Sample Opportunity';
      var sub = document.getElementById('opptyHeroSub');
      if(sub) sub.textContent = (data.oppty.Account &middot; Primary Contact');
      var smart=document.getElementById('oppty-smart-name');
      if(smart) smart.textContent = data.oppty.name || 'this opportunity';
    }catch(e){}
    setStage(data.oppty.stage||'Qualification');
  }
  function renderTimeline(snapshot){
    var data=snapshot||state||fallbackState;
    if(!tl) return;
    tl.innerHTML='';
    (data.oppty && data.oppty.activities || []).forEach(function(a){
      var div=document.createElement('div');
      div.className='item';
      div.innerHTML='<div class="t">'+a.ts+'</div><div><div class="who">'+a.type+'</div><div class="what">'+a.text+'</div></div>';
      tl.appendChild(div);
    });
  }
  Array.prototype.slice.call(document.querySelectorAll('.stage .s')).forEach(function(sp){ sp.addEventListener('click', function(){ setStage(sp.dataset.v); }); });
  var pursuitBtn=document.getElementById('btnCreatePursuit');
  if(pursuitBtn){
    pursuitBtn.addEventListener('click', function(){
      var payload=formToObject(document.getElementById('oppForm'));
      persistOpportunity(payload);
      var statusEl=document.getElementById('status');
      var progEl=document.getElementById('prog');
      if(statusEl) statusEl.textContent='Running OIC job...';
      if(progEl) progEl.style.width='60%';
      var finish=function(){
        if(statusEl) statusEl.textContent='Completed';
        if(progEl) progEl.style.width='100%';
        setTimeout(function(){ try{ window.location='ppm_pursuit.html'; }catch(e){} }, 600);
      };
      if(window.RWD && typeof RWD.createPursuitViaOIC==='function'){
        try{ RWD.createPursuitViaOIC(finish); }catch(err){ console.error('createPursuitViaOIC failed', err); finish(); }
      }else{
        setTimeout(finish, 400);
      }
    });
  }
  updateHero(state);
  renderTimeline(state);
  initOpptySmartBanner();
  if(window.RWD && typeof RWD.subscribe==='function'){
    try{
      RWD.subscribe(function(snapshot){
        state=snapshot||safeSnapshot();
        updateHero(state);
        renderTimeline(state);
        try{ renderOppsPreview(); }catch(e){}
      });
    }catch(err){
      console.warn('RWD.subscribe failed', err);
    }
  }else if(hasRWD){
    setInterval(function(){
      var fresh=safeSnapshot();
      if((fresh.oppty.activities||[]).length !== (state.oppty.activities||[]).length){
        state=fresh;
        renderTimeline(state);
      }
    }, 800);
  }
  try{ renderOppsPreview(); }catch(e){}
    var input=document.getElementById('opptyAiInput');
    if(input){
      input.addEventListener('keypress', function(ev){ if(ev.key==='Enter'){ ev.preventDefault(); runOpptyAISummary('overview'); } });
      input.addEventListener('blur', function(){ if(input.value.trim()){ runOpptyAISummary('overview'); } });
    }
});
// Add New Opportunity modal handlers
function openAddOppty(){
  var m = document.getElementById('add-oppty-modal');
  if(window.ModalManager && typeof ModalManager.showModal==='function'){
    try{ ModalManager.showModal('add-oppty-modal'); document.body.classList.add('modal-visible'); return; }catch(e){}
  }
  if(m){
    m.style.display='flex';
    m.setAttribute('aria-hidden','false');
    document.body.classList.add('modal-visible');
    var f = m.querySelector('input[name="name"]'); if(f) f.focus();
  }
}
function closeAddOppty(){
  var m=document.getElementById('add-oppty-modal');
  if(window.ModalManager && typeof ModalManager.closeModal==='function'){
    try{ ModalManager.closeModal('add-oppty-modal'); }catch(e){}
  }
  if(m){ m.style.display='none'; m.setAttribute('aria-hidden','true'); }
  document.body.classList.remove('modal-visible');
}

document.addEventListener('DOMContentLoaded', function(){
  var btn = document.getElementById('add-new-oppty-btn'); if(btn) btn.addEventListener('click', openAddOppty);
  var form = document.getElementById('addOpptyForm'); if(form){ form.addEventListener('submit', function(ev){ ev.preventDefault(); try{ var obj=formToObject(form); persistOpportunity(obj); }catch(e){ console.error('save oppty failed', e); if(typeof showToast==='function') showToast('Save failed'); }
      closeAddOppty(); try{ renderOppsPreview(); }catch(e){}
  }); }
  // initial preview render
  try{ renderOppsPreview(); }catch(e){}
});

function persistOpportunity(obj){
  var saved=false;
  if(window.RWD && typeof RWD.saveOppty==='function'){
    try{ RWD.saveOppty(obj); saved=true; }catch(e){ console.error('RWD.saveOppty failed', e); }
  } else if(window.RWD && typeof RWD.get==='function' && typeof RWD.set==='function'){
    try{
      var s = RWD.get() || {};
      s.opportunities = s.opportunities || [];
      s.opportunities.unshift(obj);
      s.oppty = s.oppty || {};
      s.oppty.activities = s.oppty.activities || [];
      s.oppty.activities.unshift({ ts:new Date().toLocaleString(), type:'Create', text: 'Opportunity created: ' + (obj.name || obj.account || '') });
      RWD.set(s);
      saved=true;
    }catch(err){ console.warn('Fallback RWD.set failed', err); }
  } else {
    window.__demoFallbackOpps = window.__demoFallbackOpps || [];
    window.__demoFallbackOpps.unshift(obj);
    saved=true;
  }
  if(saved){
    if(typeof showToast==='function') showToast('Opportunity saved'); else alert('Opportunity saved');
  } else {
    console.warn('Opportunity not persisted (demo services unavailable)');
  }
}

function formToObject(form){
  var obj={};
  if(!form) return obj;
  try{
    var fd=new FormData(form);
    fd.forEach(function(v,k){ obj[k]=v; });
  }catch(e){
    console.warn('FormData unavailable, attempting manual serialization', e);
    var elements = form.elements || [];
    Array.prototype.forEach.call(elements, function(el){ if(el.name) obj[el.name]=el.value; });
  }
  return obj;
}

// Render recent opportunities preview
function renderOppsPreview(){
  var container = document.getElementById('opps-preview'); if(!container) return;
  var s = (window.RWD && typeof RWD.get==='function')?RWD.get():null;
  var opps = (s && s.opportunities) ? s.opportunities : (window.__demoFallbackOpps || []);
  var total = opps ? opps.length : 0;
  var countLabel = document.getElementById('opps-count-label'); if(countLabel) countLabel.textContent = total + ' Results';
  if(!opps || opps.length===0){ container.innerHTML = '<div style="color:var(--rw-muted)">No opportunities yet. Click "Create Opportunity" to add one.</div>'; return; }
  var html='<table class="table" style="width:100%"><thead><tr><th>Name</th><th>Account</th><th>Amount</th><th>Stage</th><th style="width:110px">Actions</th></tr></thead><tbody>';
  opps.slice(0,20).forEach(function(o,idx){
    var acct=escapeHtml(o.account || o.company || '');
    html += '<tr><td>'+escapeHtml(o.name||'')+'</td><td>'+acct+'</td><td>'+formatCurrency(o.amount)+'</td><td>'+escapeHtml(o.stage||'')+'</td><td><button class="btn" onclick="prefillAddOppty('+idx+')">Import</button></td></tr>';
  });
  html += '</tbody></table>'; container.innerHTML = html;
}

function prefillAddOppty(index){
  var s = (window.RWD && typeof RWD.get==='function')?RWD.get():null;
  var opps = (s && s.opportunities)?s.opportunities:(window.__demoFallbackOpps || []);
  if(!opps || opps.length===0) return;
  var opp = opps[index] || opps[0];
  var form = document.getElementById('addOpptyForm'); if(!form) return;
  Object.keys(opp).forEach(function(k){ try{ if(form.elements[k]) form.elements[k].value = opp[k]; }catch(e){} });
  if(form.elements.account && !form.elements.account.value && opp.company){ form.elements.account.value = opp.company; }
  openAddOppty();
}

function escapeHtml(s){ return String(s||'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;').replace(/'/g,'&#39;'); }

function saveOppDraft(){ if(typeof showToast==='function') showToast('Draft saved (demo)'); }
function cancelOppDraft(){ if(typeof showToast==='function') showToast('Draft canceled'); }
function formatCurrency(val){ var num=Number(val); return num?('$'+num.toLocaleString()):''; }

function initOpptySmartBanner(){
  var buttons=document.querySelectorAll('[data-oppty-action]');
  buttons.forEach(function(btn){
    btn.addEventListener('click', function(){ fireOpptyAction(btn.dataset.opptyAction || btn.textContent); });
  });
  var select=document.getElementById('oppty-smart-select');
  var apply=document.getElementById('oppty-smart-apply');
  if(apply){
    apply.addEventListener('click', function(){ if(select) fireOpptyAction(select.value); });
  }
}

function fireOpptyAction(action){
  if(!action) return;
  var handled=openOpptyActionModal(action);
  if(window.RWD && typeof RWD.actOppty==='function'){
    RWD.actOppty(action);
  }
  if(!handled && typeof showToast==='function') showToast(action+' triggered');
}

function openOpptyActionModal(action){
  var modal=document.getElementById('oppty-action-modal');
  if(!modal) return false;
  var forms=modal.querySelectorAll('[data-oppty-form]');
  var found=false;
  forms.forEach(function(form){
    var show=form.dataset.opptyForm===action;
    form.style.display=show?'flex':'none';
    if(show){
      found=true;
      prefillOpptyAction(form);
      setTimeout(function(){ var field=form.querySelector('input,textarea,select'); if(field) field.focus(); }, 30);
    }
  });
  if(!found) return false;
  var title=document.getElementById('opptyActionTitle'); if(title) title.textContent=action;
  modal.style.display='flex';
  modal.setAttribute('aria-hidden','false');
  document.body.classList.add('modal-visible');
  return true;
}

function closeOpptyAction(){
  var modal=document.getElementById('oppty-action-modal');
  if(!modal) return;
  modal.style.display='none';
  modal.setAttribute('aria-hidden','true');
  document.body.classList.remove('modal-visible');
}

function prefillOpptyAction(form){
  var state=(window.RWD && typeof RWD.get==='function')?(function(){ try{return RWD.get();}catch(e){ return {}; } })():{};
  var opp=state.oppty||{};
  if(form.dataset.opptyForm==='Send Quote'){
    if(form.elements.quoteName && !form.elements.quoteName.value){ form.elements.quoteName.value=(opp.name||'Opportunity')+' Quote'; }
    if(form.elements.quoteAmount && !form.elements.quoteAmount.value && opp.amount){ form.elements.quoteAmount.value=opp.amount; }
  }
  if(form.dataset.opptyForm==='Launch DocuSign'){
    if(form.elements.docName && !form.elements.docName.value){ form.elements.docName.value=(opp.name||'Opportunity')+' SOW'; }
  }
  if(form.dataset.opptyForm==='Create Pursuit'){
    if(form.elements.pursuitName && !form.elements.pursuitName.value){ form.elements.pursuitName.value=(opp.name||'Opportunity')+' Pursuit'; }
    if(form.elements.pursuitBudget && !form.elements.pursuitBudget.value && opp.amount){ form.elements.pursuitBudget.value=opp.amount; }
  }
}

function submitOpptyAction(ev){
  if(ev) ev.preventDefault();
  var form=ev?ev.target:null;
  if(!form) return false;
  var action=form.dataset.opptyForm || 'Action';
  switch(action){
    case 'Send Quote':
      launchOpptyQuote(form);
      break;
    case 'Request Approval':
      runApproval(form);
      break;
    case 'Launch DocuSign':
      launchDocuSignFlow(form);
      break;
    case 'Create Pursuit':
      pushPursuitFromOppty(form);
      break;
    case 'Escalate':
      escalateOppty(form);
      break;
    default:
      if(typeof showToast==='function') showToast(action+' completed');
  }
  form.reset();
  closeOpptyAction();
  return false;
}

function launchOpptyQuote(form){
  var name=(form.elements.quoteName && form.elements.quoteName.value)||'Quote';
  if(window.RWD && typeof RWD.runOICJob==='function'){
    try{ RWD.runOICJob('CPQ Quote: '+name); }catch(e){ console.warn('runOICJob failed', e); }
  }
  try{ window.open('quote_to_docusign.html','_blank','noopener'); }catch(err){ console.warn('open quote screen failed', err); }
  if(typeof showToast==='function') showToast('Quote '+name+' launched to CPQ');
}

function runApproval(form){
  var type=form.elements.approvalType ? form.elements.approvalType.value : 'Approval';
  if(window.RWD && typeof RWD.runOICJob==='function'){
    try{ RWD.runOICJob('Approval: '+type); }catch(e){ console.warn('approval push failed', e); }
  }
  if(typeof showToast==='function') showToast(type+' approval requested');
}

function launchDocuSignFlow(form){
  var doc=form.elements.docName ? form.elements.docName.value : 'Agreement';
  if(window.RWD && typeof RWD.runOICJob==='function'){
    try{ RWD.runOICJob('DocuSign: '+doc); }catch(e){ console.warn('docuSign job failed', e); }
  }
  try{ window.open('quote_to_docusign.html','_blank','noopener'); }catch(err){ console.warn('DocuSign page open failed', err); }
  if(typeof showToast==='function') showToast('DocuSign launched for '+doc);
}

function pushPursuitFromOppty(form){
  var name=form.elements.pursuitName ? form.elements.pursuitName.value : 'Pursuit';
  var go=function(){
    try{ window.open('ppm_pursuit.html','_blank','noopener'); }catch(e){ console.warn('open pursuit page failed', e); }
    if(typeof showToast==='function') showToast('Pursuit "'+name+'" created');
  };
  if(window.RWD && typeof RWD.createPursuitViaOIC==='function'){
    try{ RWD.createPursuitViaOIC(go); return; }catch(e){ console.warn('createPursuitViaOIC failed', e); }
  }
  go();
}

function runOpptyAISummary(mode){
  var target=document.getElementById('opptyAiSummaryText');
  if(!target) return false;
  var input=document.getElementById('opptyAiInput');
  var query=(input && input.value.trim())||'';
  var state=(window.RWD && typeof RWD.get==='function')?(function(){ try{return RWD.get();}catch(e){ return {}; } })():{};
  var opp=state.oppty || {name:'Sample Opportunity', account:'Warner Design', stage:'Qualification', amount:1200000};
  var msg='';
  if(mode==='risk'){
    msg='Risks: approval pending for '+(opp.name||'deal')+', DocuSign stalled, and invoice aged 30 days. Recommend escalating pricing + partner review.';
  }else if(mode==='action'){
    msg='Smart Actions: Launch DocuSign for proposal, request executive approval, and push pursuit handoff to PPM.';
  }else{
    msg='Summary: '+(opp.name||'Opportunity')+' with '+(opp.account||'customer')+' at '+(opp.stage||'Qualification')+' worth $'+Number(opp.amount||0).toLocaleString()+'. Next milestone is DocuSign + partner validation.';
  }
  target.textContent=msg;
  var panel=document.getElementById('opptySearchResults');
  if(panel){
    panel.hidden=false;
    var focus=query?('Focus: '+escapeHtml(query)):'Latest AI insight';
    panel.innerHTML='<h4>Opportunity Insights</h4><p>'+focus+'</p><p>'+escapeHtml(msg)+'</p>';
  }
  return false;
}

function escalateOppty(form){
  var target=form.elements.escalateTo ? form.elements.escalateTo.value : 'Leadership';
  var body=form.elements.escalateSummary ? form.elements.escalateSummary.value : '';
  if(window.RWD && typeof RWD.get==='function' && typeof RWD.set==='function'){
    try{
      var state=RWD.get();
      state.oppty=state.oppty||{};
      state.oppty.activities=state.oppty.activities||[];
      state.oppty.activities.unshift({ ts:new Date().toLocaleString(), type:'Escalation', text: 'Sent to '+target+': '+body, who:'Sales' });
      RWD.set(state);
    }catch(e){ console.warn('escalation log failed', e); }
  }
  if(typeof showToast==='function') showToast('Escalation sent to '+target);
}
</script>
<nav class="vision-footer" aria-label="Global navigation">    <a href="sales_cloud.html">Sales Dashboard</a>    <a href="account_360.html">Accounts</a>    <a href="cx_lead.html">Leads</a>
  <a href="cx_opportunity.html" class="active">Opportunities</a>    <a href="quote_to_docusign.html">Quotes</a>
</nav>
<div class="footer">Copyright Demo - Redwood-inspired mockup</div>
</body>
</html>








